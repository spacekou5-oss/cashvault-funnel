<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Budget Split Calculator</title>

    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Tailwind CSS via CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Chart.js and Datalabels Plugin via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.1.0"></script>


    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827;
            background-image:
                radial-gradient(at 20% 80%, hsla(260, 50%, 30%, 0.2) 0px, transparent 50%),
                radial-gradient(at 80% 10%, hsla(210, 45%, 40%, 0.25) 0px, transparent 50%),
                linear-gradient(to bottom right, #111827, #131b31, #111827);
        }
        .btn-active {
            background-color: #f59e0b; color: #111827; border-color: #f59e0b;
        }
        .btn-special-active {
            background-color: #ec4899; color: #111827; border-color: #ec4899;
        }
        .premium-input {
            background-color: rgba(17, 24, 39, 0.5); border-color: rgba(255, 255, 255, 0.1); color: #f1f5f9;
        }
        .premium-input::placeholder { color: #64748b; }
        .premium-input:focus {
             border-color: #f59e0b; box-shadow: 0 0 0 2px rgba(245, 158, 11, 0.4);
        }
        /* UPDATED: Container now needs to be relative for stacking */
        .chart-container { 
            position: relative; 
            height: 300px; 
            width: 300px; 
        }
        /* ADDED: Styles for the stacked canvases */
        .chart-container canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100% !important;
            height: 100% !important;
        }
        /* Make blossom canvas interactive-proof */
        #blossom-canvas {
            pointer-events: none; 
        }
        .explanation-content { transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out; }
    </style>
</head>
<body class="text-slate-300">

    <div class="container mx-auto max-w-4xl p-4 sm:p-6 md:p-8 min-h-screen flex flex-col justify-center">

        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-slate-100 to-slate-400">Find the Perfect Budgeting System for You</h1>
            <p class="text-lg text-slate-400 mt-2">Enter your income to instantly see your personalized budget breakdown.</p>
        </header>

        <main class="bg-slate-900/60 backdrop-blur-xl p-6 sm:p-8 rounded-2xl shadow-2xl border border-white/10">

            <section id="income-section">
                <label for="income" class="block text-lg font-semibold mb-2 text-slate-200">Enter Your Income</label>
                <div class="flex flex-col sm:flex-row gap-3">
                    <input type="number" id="income" placeholder="enter the amount of money you want to split" class="flex-grow w-full text-lg p-3 border rounded-lg transition duration-200 outline-none premium-input">
                    <div class="flex bg-slate-800/80 p-1 rounded-lg border border-white/5">
                        <button id="monthly-btn" class="w-full sm:w-auto px-4 py-2 rounded-md text-sm font-medium transition-colors btn-active">Monthly</button>
                        <button id="annual-btn" class="w-full sm:w-auto px-4 py-2 rounded-md text-sm font-medium transition-colors text-slate-300">Annual</button>
                    </div>
                </div>
            </section>

            <section id="system-selector" class="mt-8">
                 <h2 class="text-lg font-semibold mb-3 text-slate-200">Choose Your Budgeting Method</h2>
                 <div class="grid grid-cols-2 lg:grid-cols-4 gap-2 sm:gap-3">
                     <button data-system="50-30-20" class="budget-btn p-3 text-sm font-semibold border border-white/10 rounded-lg transition-colors hover:bg-amber-500 hover:border-amber-500 hover:text-slate-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-amber-500 btn-active">50/30/20 Rule</button>
                     <button data-system="pay-yourself-first" class="budget-btn p-3 text-sm font-semibold border border-white/10 rounded-lg transition-colors hover:bg-amber-500 hover:border-amber-500 hover:text-slate-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-amber-500">Pay Yourself First</button>
                     <button data-system="kiko" class="budget-btn p-3 text-sm font-semibold border border-white/10 rounded-lg transition-colors hover:bg-amber-500 hover:border-amber-500 hover:text-slate-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-amber-500">Kiko's System</button>
                     <button data-system="fatima" class="budget-btn p-3 text-sm font-semibold border border-pink-400/50 rounded-lg transition-colors text-pink-300 hover:bg-pink-500 hover:border-pink-500 hover:text-slate-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-900 focus:ring-pink-500">For Fatima</button>
                 </div>
            </section>
            
            <section id="explanation-section" class="mt-6 p-5 bg-slate-800/50 rounded-lg border border-white/10">
                <div class="explanation-content" data-system="50-30-20">
                    <h4 class="font-bold text-lg text-slate-100">50/30/20 Rule (Simple Split Budget)</h4>
                    <p class="text-slate-300 mt-2"><strong class="text-amber-400">The Split:</strong> Your income is divided into three simple categories: 50% for Needs (rent, bills), 30% for Wants (entertainment), and 20% for Savings & Debt Repayment.</p>
                    <p class="mt-2"><strong class="text-amber-400">Advantages for Beginners:</strong> The primary advantage is simplicity. The clear percentages are easy to remember and apply without intensive tracking, making it a flexible and less intimidating way to start.</p>
                </div>
                <div class="explanation-content hidden" data-system="pay-yourself-first">
                    <h4 class="font-bold text-lg text-slate-100">Pay Yourself First Budget</h4>
                    <p class="text-slate-300 mt-2"><strong class="text-amber-400">The Split:</strong> The moment you receive your income, you immediately transfer a fixed percentage (e.g., 20%) directly into your savings or investment accounts. The rest is available for all other expenses.</p>
                    <p class="mt-2"><strong class="text-amber-400">Advantages for Beginners:</strong> This method automates the habit of saving and investing. It removes the temptation to spend your savings, as the money is set aside before you can even touch it.</p>
                </div>
                 <div class="explanation-content hidden" data-system="fatima">
                    <h4 class="font-bold text-lg text-pink-300">The System Kiko Made For Fatima</h4>
                    <p class="text-slate-300 mt-2"><strong class="text-pink-400">The Split:</strong> A balanced approach: 45% for Needs, 25% for Wants, 15% for Savings, and 15% for Investing.</p>
                    <p class="mt-2 text-slate-300 italic">"I have made this system specifically for you knowing how you are as a person, and I hope that you use it and can lead you to a great financial future."</p>
                    <p class="mt-1 text-right text-pink-400/80">- Love, Kiko</p>
                </div>
                <div class="explanation-content hidden" data-system="kiko">
                    <h4 class="font-bold text-lg text-slate-100">Kiko's Budgeting System</h4>
                    <p class="text-slate-300 mt-2"><strong class="text-amber-400">The Split:</strong> An aggressive, investment-focused strategy: Needs are a fixed $40, Wants get 12%, an Emergency Fund gets 8%, and the entire rest of your income is dedicated to Investing.</p>
                    <p class="mt-2"><strong class="text-amber-400">Advantages for Beginners:</strong> Ideal for disciplined people with low living costs. It automates essential allocations and maximizes the amount going towards wealth-building above all else.</p>
                </div>
            </section>

            <section id="results-section" class="mt-8 pt-6 border-t border-white/10 min-h-[300px]">
                <div class="flex flex-col md:flex-row gap-8 items-center justify-between">
                    <div id="breakdown-details" class="w-full md:w-1/2 space-y-3"></div>
                    <div class="w-full md:w-1/2 flex items-center justify-center">
                        <!-- UPDATED: Container now holds two canvases -->
                        <div class="chart-container">
                            <canvas id="budget-chart"></canvas>
                            <canvas id="blossom-canvas"></canvas>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <footer class="mt-8 text-center bg-black/20 backdrop-blur-xl border border-white/10 p-8 rounded-2xl shadow-2xl">
            <h3 class="text-2xl font-bold text-slate-100">Ready to Take the Next Step?</h3>
            <p class="mt-2 max-w-xl mx-auto text-slate-400">Get a personalized plan or automate your entire financial system with our premium tools.</p>
            <div class="flex flex-col sm:flex-row gap-4 justify-center mt-6">
                 <form class="flex flex-grow sm:flex-grow-0 gap-3">
                    <input type="email" placeholder="Enter your email" class="flex-grow w-full p-3 border rounded-lg outline-none premium-input" required>
                    <button type="submit" class="bg-slate-200 text-slate-900 font-bold px-5 py-3 rounded-lg hover:bg-white transition-colors">Get My Plan</button>
                </form>
                <button class="bg-amber-500 text-slate-900 font-bold px-6 py-3 rounded-lg hover:bg-amber-400 transition-colors">Automate My Finances</button>
            </div>
        </footer>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const incomeInput = document.getElementById('income'), monthlyBtn = document.getElementById('monthly-btn'), annualBtn = document.getElementById('annual-btn'), budgetBtns = document.querySelectorAll('.budget-btn'), explanationContents = document.querySelectorAll('.explanation-content'), breakdownDetails = document.getElementById('breakdown-details');
            
            // UPDATED: Get references to both canvases
            const chartCanvas = document.getElementById('budget-chart');
            const blossomCanvas = document.getElementById('blossom-canvas');
            const blossomCtx = blossomCanvas.getContext('2d');

            let state = { income: 0, period: 'monthly', system: '50-30-20' }, budgetChart = null;
            
            // --- CHERRY BLOSSOM ANIMATION LOGIC ---
            let blossoms = [];
            let animationFrameId = null;
            const BLOSSOM_COUNT = 50;

            class BlossomParticle {
                constructor() {
                    this.x = Math.random() * blossomCanvas.width;
                    this.y = Math.random() * blossomCanvas.height;
                    this.size = Math.random() * 2 + 1;
                    this.speedX = Math.random() * 1 - 0.5;
                    this.speedY = Math.random() * 1 + 0.5;
                    this.color = `rgba(236, 72, 153, ${Math.random() * 0.7 + 0.3})`;
                }
                update() {
                    this.x += this.speedX;
                    this.y += this.speedY;
                    if (this.y > blossomCanvas.height) {
                        this.y = -5;
                        this.x = Math.random() * blossomCanvas.width;
                    }
                }
                draw() {
                    blossomCtx.fillStyle = this.color;
                    blossomCtx.beginPath();
                    blossomCtx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                    blossomCtx.fill();
                }
            }

            function initBlossoms() {
                blossoms = [];
                for (let i = 0; i < BLOSSOM_COUNT; i++) {
                    blossoms.push(new BlossomParticle());
                }
            }

            function animateBlossoms() {
                blossomCtx.clearRect(0, 0, blossomCanvas.width, blossomCanvas.height);
                for (let i = 0; i < blossoms.length; i++) {
                    blossoms[i].update();
                    blossoms[i].draw();
                }
                animationFrameId = requestAnimationFrame(animateBlossoms);
            }

            function startBlossomAnimation() {
                if (!animationFrameId) { // Prevent multiple loops
                    blossomCanvas.style.display = 'block';
                    initBlossoms();
                    animateBlossoms();
                }
            }

            function stopBlossomAnimation() {
                if (animationFrameId) {
                    cancelAnimationFrame(animationFrameId);
                    animationFrameId = null;
                    blossomCtx.clearRect(0, 0, blossomCanvas.width, blossomCanvas.height);
                    blossomCanvas.style.display = 'none';
                }
            }
             // Handle resizing
            const chartContainer = document.querySelector('.chart-container');
            new ResizeObserver(() => {
                blossomCanvas.width = chartContainer.clientWidth;
                blossomCanvas.height = chartContainer.clientHeight;
                if(state.system === 'fatima'){
                    initBlossoms();
                }
            }).observe(chartContainer);
            // --- END OF ANIMATION LOGIC ---


            const chartColors = { 
                'Needs': '#f59e0b', 'Wants': '#818cf8', 'Savings & Debt': '#60a5fa', 'Savings': '#60a5fa', 'Everything Else': '#818cf8', 'Investing': '#22c55e',
                'Emergency Fund': '#f43f5e'
            };

            const formatCurrency = (amount) => new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(amount);
            
            const centerTextPlugin = {
                id: 'centerText',
                afterDraw: (chart) => {
                    if (chart.options.plugins.centerText.display) {
                        let ctx = chart.ctx; ctx.save();
                        let centerX = (chart.chartArea.left + chart.chartArea.right) / 2; let centerY = (chart.chartArea.top + chart.chartArea.bottom) / 2;
                        ctx.textAlign = 'center'; ctx.textBaseline = 'middle';
                        ctx.font = '700 24px Inter, sans-serif'; ctx.fillStyle = '#f1f5f9'; ctx.fillText(chart.options.plugins.centerText.mainText, centerX, centerY - 10);
                        ctx.font = '500 14px Inter, sans-serif'; ctx.fillStyle = '#94a3b8'; ctx.fillText(chart.options.plugins.centerText.subText, centerX, centerY + 15);
                        ctx.restore();
                    }
                }
            };
            
            const initializeChart = () => {
                Chart.register(ChartDataLabels, centerTextPlugin);
                budgetChart = new Chart(chartCanvas.getContext('2d'), { 
                    type: 'doughnut', data: { labels: [], datasets: [{ data: [], backgroundColor: [], borderColor: 'rgba(30, 41, 59, 0.6)', borderWidth: 5, hoverOffset: 15 }] }, 
                    options: { 
                        responsive: true, maintainAspectRatio: false, cutout: '75%',
                        plugins: {
                            legend: { display: false }, tooltip: { enabled: false }, centerText: { display: true, mainText: '$0', subText: 'Monthly Income' },
                            datalabels: {
                                color: '#ffffff', textAlign: 'center', font: { weight: 'bold', size: 14 }, textShadow: { stroke: 'rgba(0,0,0,0.5)', blur: 4, color: 'rgba(0,0,0,0.5)' },
                                formatter: (value, context) => { const sum = context.chart.data.datasets[0].data.reduce((a, b) => a + b, 0); const percentage = (value / sum * 100).toFixed(0) + '%'; const label = context.chart.data.labels[context.dataIndex]; return `${label}\n${percentage}`; },
                                display: (context) => context.dataset.data[context.dataIndex] > 0
                            }
                        }, 
                        animation: { animateScale: true, animateRotate: true }
                    } 
                });
            };
            
            const calculateAndDisplay = () => {
                const monthlyIncome = state.period === 'annual' ? state.income / 12 : state.income; if (monthlyIncome < 0) return; let breakdown, title;
                switch (state.system) {
                    case 'pay-yourself-first': title = 'Pay Yourself First'; breakdown = { 'Savings': monthlyIncome * 0.20, 'Everything Else': monthlyIncome * 0.80 }; break;
                    case 'fatima': title = "For Fatima's Future"; breakdown = { 'Needs': monthlyIncome * 0.45, 'Wants': monthlyIncome * 0.25, 'Savings': monthlyIncome * 0.15, 'Investing': monthlyIncome * 0.15 }; break;
                    case 'kiko': title = "Kiko's System"; const wants = monthlyIncome * 0.12; const emergency = monthlyIncome * 0.08; const investing = Math.max(0, monthlyIncome - 40 - wants - emergency); breakdown = { 'Needs': 40, 'Wants': wants, 'Emergency Fund': emergency, 'Investing': investing }; break;
                    default: title = '50/30/20 Rule'; breakdown = { 'Needs': monthlyIncome * 0.50, 'Wants': monthlyIncome * 0.30, 'Savings & Debt': monthlyIncome * 0.20 };
                }
                updateDisplay(breakdown, title, monthlyIncome);
                updateChart(breakdown, monthlyIncome);
            };

            const updateDisplay = (breakdown, title, monthlyIncome) => {
                breakdownDetails.innerHTML = `<h2 class="text-2xl font-bold text-slate-100 mb-4">${title}</h2>`;
                if (!state.income || state.income <= 0) { breakdownDetails.innerHTML += '<p class="text-slate-500 py-10">Enter income to see calculation.</p>'; return; }
                const staticPercentages = { 'Needs': 50, 'Wants': 30, 'Savings & Debt': 20, 'Savings': 20, 'Everything Else': 80 };
                const fatimaPercentages = { 'Needs': 45, 'Wants': 25, 'Savings': 15, 'Investing': 15 };

                for (const category in breakdown) {
                    const amount = breakdown[category], colorValue = chartColors[category] || '#9ca3af'; let categoryText = `${category}`;
                    if(state.system === 'fatima') {
                        categoryText += ` (${fatimaPercentages[category]}%)`;
                    } else if (state.system === 'kiko') {
                        if (category === 'Needs') categoryText += ' (Fixed)'; else if (category === 'Wants') categoryText += ' (12%)'; else if (category === 'Emergency Fund') categoryText += ' (8%)'; else if (category === 'Investing') { const p = monthlyIncome > 0 ? ((amount / monthlyIncome) * 100).toFixed(0) : 0; categoryText += ` (~${p}%)`; }
                    } else if (staticPercentages[category]) { categoryText += ` (${staticPercentages[category]}%)`; }
                    const div = document.createElement('div'); div.className = 'bg-slate-800/50 p-4 rounded-lg border border-white/10 flex items-center justify-between';
                    div.innerHTML = `<div class="flex items-center"><span class="w-3 h-3 rounded-full mr-4 flex-shrink-0" style="background-color: ${colorValue};"></span><p class="font-semibold text-slate-200">${categoryText}</p></div><p class="font-bold text-lg text-slate-100">${formatCurrency(amount)}</p>`;
                    breakdownDetails.appendChild(div);
                }
            };
            
            const updateChart = (breakdown, monthlyIncome) => {
                if (!budgetChart) initializeChart(); const labels = Object.keys(breakdown), data = Object.values(breakdown);
                budgetChart.data.labels = labels; budgetChart.data.datasets[0].data = data; budgetChart.data.datasets[0].backgroundColor = labels.map(label => chartColors[label] || '#9ca3af');
                budgetChart.options.plugins.centerText.mainText = formatCurrency(monthlyIncome || 0);
                budgetChart.update();
            };

            incomeInput.addEventListener('input', (e) => { state.income = parseFloat(e.target.value) || 0; calculateAndDisplay(); });
            monthlyBtn.addEventListener('click', () => { if (state.period !== 'monthly') { state.period = 'monthly'; monthlyBtn.classList.add('btn-active'); annualBtn.classList.remove('btn-active'); if(state.income > 0) { incomeInput.value = (state.income / 12).toFixed(0); incomeInput.dispatchEvent(new Event('input')); } } });
            annualBtn.addEventListener('click', () => { if (state.period !== 'annual') { state.period = 'annual'; annualBtn.classList.add('btn-active'); monthlyBtn.classList.remove('btn-active'); if(state.income > 0) { incomeInput.value = (state.income * 12).toFixed(0); incomeInput.dispatchEvent(new Event('input')); } } });
            budgetBtns.forEach(btn => btn.addEventListener('click', () => {
                budgetBtns.forEach(b => {
                    b.classList.remove('btn-active');
                    b.classList.remove('btn-special-active');
                }); 

                if (btn.dataset.system === 'fatima') {
                    btn.classList.add('btn-special-active');
                    startBlossomAnimation();
                } else {
                    btn.classList.add('btn-active');
                    stopBlossomAnimation();
                }
                
                state.system = btn.dataset.system;
                explanationContents.forEach(content => content.classList.toggle('hidden', content.dataset.system !== state.system));
                calculateAndDisplay();
            }));

            initializeChart(); 
            calculateAndDisplay();
            stopBlossomAnimation(); // Ensure it's off by default
        });
    </script>
</body>
</html>
