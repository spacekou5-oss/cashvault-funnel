<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Command Center | @koutalksmoney</title>
    
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-primary: #050505;
            --bg-secondary: #0a0a0a;
            --bg-card: #0f0f0f;
            --bg-card-hover: #141414;
            --accent-green: #22c55e;
            --accent-green-dim: rgba(34, 197, 94, 0.15);
            --accent-green-glow: rgba(34, 197, 94, 0.4);
            --accent-gold: #fbbf24;
            --accent-gold-dim: rgba(251, 191, 36, 0.15);
            --accent-gold-glow: rgba(251, 191, 36, 0.4);
            --accent-blue: #3b82f6;
            --accent-purple: #8b5cf6;
            --accent-pink: #ec4899;
            --accent-pink-dim: rgba(236, 72, 153, 0.15);
            --accent-pink-glow: rgba(236, 72, 153, 0.4);
            --text-primary: #ffffff;
            --text-secondary: #a1a1aa;
            --text-muted: #52525b;
            --border: #1f1f1f;
            --border-active: #2a2a2a;
            --danger: #ef4444;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Space Grotesk', -apple-system, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            overflow-x: hidden;
        }

        .bg-grid {
            position: fixed; inset: 0;
            background-image: 
                linear-gradient(rgba(34, 197, 94, 0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(34, 197, 94, 0.02) 1px, transparent 1px);
            background-size: 60px 60px;
            pointer-events: none; z-index: 0;
        }

        .bg-glow {
            position: fixed; width: 800px; height: 800px; border-radius: 50%;
            filter: blur(200px); opacity: 0.08; pointer-events: none; z-index: 0;
        }
        .bg-glow-1 { top: -400px; left: -200px; background: var(--accent-green); }
        .bg-glow-2 { bottom: -400px; right: -200px; background: var(--accent-gold); opacity: 0.05; }

        .container {
            max-width: 900px; margin: 0 auto; padding: 30px 20px 60px;
            position: relative; z-index: 1;
        }

        /* ===================== */
        /* CELEBRATION PARTICLES */
        /* ===================== */
        .celebration-container {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9000; overflow: hidden;
        }
        .c-particle {
            position: absolute; border-radius: 50%;
            animation: c-particle-burst 1.8s ease-out forwards;
        }
        .c-particle.square { border-radius: 2px; }
        @keyframes c-particle-burst {
            0% { opacity: 1; transform: translate(0, 0) scale(1) rotate(0deg); }
            100% { opacity: 0; transform: translate(var(--tx), var(--ty)) scale(0) rotate(var(--rot)); }
        }

        /* ===================== */
        /* ACCESS GATE           */
        /* ===================== */
        .access-gate {
            display: none; position: relative; z-index: 1;
            min-height: 100vh; overflow: hidden;
        }
        .access-gate.show { display: block; }

        .gate-preview {
            position: absolute; inset: 0; z-index: 0;
            padding: 30px 20px; max-width: 900px; margin: 0 auto;
            filter: blur(8px); opacity: 0.25; pointer-events: none;
            -webkit-user-select: none; user-select: none;
        }
        .gp-header { display: flex; justify-content: space-between; align-items: center; padding-bottom: 20px; border-bottom: 1px solid var(--border); margin-bottom: 20px; }
        .gp-logo { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.1em; }
        .gp-logo span { color: var(--accent-green); }
        .gp-badge { padding: 8px 14px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 8px; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; color: var(--accent-gold); }
        .gp-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px; }
        .gp-stat { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; padding: 16px; text-align: center; }
        .gp-stat.green { border-color: rgba(34,197,94,0.3); }
        .gp-stat.gold { border-color: rgba(251,191,36,0.3); }
        .gp-stat-val { font-family: 'JetBrains Mono', monospace; font-size: 1.3rem; font-weight: 800; color: var(--text-primary); }
        .gp-stat.green .gp-stat-val { color: var(--accent-green); }
        .gp-stat.gold .gp-stat-val { color: var(--accent-gold); }
        .gp-stat-label { font-size: 0.6rem; color: var(--text-muted); text-transform: uppercase; margin-top: 4px; }
        .gp-velocity { background: var(--bg-card); border: 1px solid rgba(139,92,246,0.3); border-radius: 14px; padding: 16px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .gp-velocity-label { font-size: 0.85rem; font-weight: 700; color: var(--text-primary); }
        .gp-velocity-score { font-family: 'JetBrains Mono', monospace; font-size: 1.5rem; font-weight: 800; color: var(--accent-purple); }
        .gp-level { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; padding: 16px; margin-bottom: 20px; }
        .gp-level-bar { height: 6px; background: var(--bg-secondary); border-radius: 6px; overflow: hidden; margin-top: 10px; }
        .gp-level-fill { height: 100%; width: 60%; background: linear-gradient(90deg, #92400e, #fbbf24); border-radius: 6px; }
        .gp-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        .gp-card { display: flex; align-items: center; gap: 10px; padding: 14px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 10px; }
        .gp-card.done { border-color: rgba(34,197,94,0.3); }
        .gp-card-icon { width: 36px; height: 36px; background: var(--bg-secondary); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1rem; }
        .gp-card.done .gp-card-icon { background: var(--accent-green-dim); }
        .gp-card-text { font-size: 0.8rem; font-weight: 600; color: var(--text-primary); }
        .gp-card-status { margin-left: auto; font-size: 1rem; }

        .gate-overlay {
            position: relative; z-index: 2;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            min-height: 100vh; padding: 40px 20px; text-align: center;
        }

        .gate-content { max-width: 420px; width: 100%; }
        .gate-brand {
            font-family: 'JetBrains Mono', monospace; font-size: 0.65rem; font-weight: 700;
            text-transform: uppercase; letter-spacing: 0.15em; color: var(--accent-green);
            margin-bottom: 8px; display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .gate-brand-dot { width: 6px; height: 6px; background: var(--accent-green); border-radius: 50%; animation: pulse 1.5s infinite; }
        .gate-title { font-size: 2.2rem; font-weight: 800; margin-bottom: 12px; letter-spacing: -0.03em; line-height: 1.1; }
        .gate-hook {
            font-family: 'JetBrains Mono', monospace; font-size: 0.95rem; font-weight: 600;
            color: var(--text-secondary); margin-bottom: 24px; line-height: 1.5;
        }
        .gate-hook strong { color: var(--accent-green); }
        .gate-proof {
            display: inline-flex; align-items: center; gap: 8px; padding: 8px 16px;
            background: var(--accent-green-dim); border: 1px solid rgba(34,197,94,0.25);
            border-radius: 50px; font-size: 0.75rem; font-weight: 600; color: var(--accent-green);
            margin-bottom: 28px;
        }
        .gate-proof-dot { width: 6px; height: 6px; background: var(--accent-green); border-radius: 50%; animation: pulse 1.5s infinite; }
        .gate-cta {
            display: flex; align-items: center; justify-content: center; gap: 10px;
            width: 100%; padding: 18px 32px;
            background: var(--accent-green); color: #000; border: none; border-radius: 12px;
            font-family: 'JetBrains Mono', monospace; font-size: 0.95rem; font-weight: 700;
            text-decoration: none; transition: all 0.3s; text-transform: uppercase; letter-spacing: 0.05em;
        }
        .gate-cta:hover { transform: translateY(-3px); box-shadow: 0 12px 35px var(--accent-green-glow); }
        .gate-pillars {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px;
            margin-bottom: 28px; width: 100%;
        }
        .gate-pillar {
            background: rgba(15,15,15,0.8); border: 1px solid var(--border);
            border-radius: 10px; padding: 12px 8px; text-align: center;
        }
        .gate-pillar-icon { font-size: 1.3rem; margin-bottom: 4px; }
        .gate-pillar-name { font-size: 0.6rem; font-weight: 700; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; }
        .gate-divider { display: flex; align-items: center; gap: 16px; margin: 24px 0; width: 100%; color: var(--text-muted); font-size: 0.7rem; }
        .gate-divider::before, .gate-divider::after { content: ''; flex: 1; height: 1px; background: var(--border); }
        .gate-id-section { width: 100%; }
        .gate-id-label { font-family: 'JetBrains Mono', monospace; font-size: 0.65rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 10px; text-align: left; }
        .gate-id-input-wrapper { display: flex; gap: 10px; }
        .gate-id-input {
            flex: 1; background: rgba(15,15,15,0.8); border: 2px solid var(--border); border-radius: 8px;
            padding: 14px 16px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace;
            font-size: 1rem; font-weight: 700; letter-spacing: 0.1em; text-transform: uppercase;
            text-align: center; outline: none; transition: all 0.3s;
        }
        .gate-id-input:focus { border-color: var(--accent-green); box-shadow: 0 0 0 3px var(--accent-green-dim); }
        .gate-id-input::placeholder { color: var(--text-muted); font-weight: 400; }
        .gate-id-btn {
            background: var(--accent-gold); color: #000; border: none; border-radius: 8px;
            padding: 14px 20px; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem;
            font-weight: 700; cursor: pointer; transition: all 0.3s; white-space: nowrap;
        }
        .gate-id-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px var(--accent-gold-glow); }
        .gate-error { color: var(--danger); font-size: 0.75rem; margin-top: 8px; display: none; text-align: left; }
        .gate-footer { margin-top: 24px; }
        .gate-footer a { color: var(--accent-green); text-decoration: none; font-size: 0.75rem; }
        .gate-footer-copy { font-size: 0.65rem; color: var(--text-muted); margin-top: 6px; }

        @media (max-width: 700px) {
            .gate-title { font-size: 1.7rem; }
            .gate-pillars { grid-template-columns: repeat(3, 1fr); gap: 6px; }
            .gate-pillar { padding: 10px 6px; }
            .gp-stats { grid-template-columns: repeat(3, 1fr); gap: 8px; }
            .gp-grid { grid-template-columns: 1fr; }
        }

        /* VERIFICATION CEREMONY */
        .gate-verify-state { display: none; width: 100%; max-width: 380px; text-align: center; }
        .gate-verify-state.show { display: block; }
        .gate-verify-id {
            font-family: 'JetBrains Mono', monospace; font-size: 1.6rem; font-weight: 800;
            color: var(--accent-green); letter-spacing: 0.08em; margin-bottom: 24px;
        }
        .gate-verify-progress {
            width: 100%; height: 4px; background: #1a1a1a;
            border-radius: 4px; overflow: hidden; margin-bottom: 14px;
        }
        .gate-verify-bar {
            height: 100%; width: 0%; background: var(--accent-green);
            border-radius: 4px; transition: width 0.5s ease;
        }
        .gate-verify-bar::after {
            content: ''; display: block; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            background-size: 200% 100%; animation: shimmer 1.5s infinite;
        }
        .gate-verify-status {
            font-family: 'JetBrains Mono', monospace; font-size: 0.75rem;
            color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.08em;
            min-height: 22px; transition: opacity 0.2s;
        }
        .gate-verify-check {
            display: flex; flex-direction: column; gap: 8px;
            margin-top: 20px; text-align: left;
        }
        .gate-verify-step {
            display: flex; align-items: center; gap: 10px;
            font-family: 'JetBrains Mono', monospace; font-size: 0.7rem;
            color: var(--text-muted); opacity: 0;
            transition: opacity 0.3s, color 0.3s;
        }
        .gate-verify-step.active { opacity: 1; color: var(--text-secondary); }
        .gate-verify-step.done { opacity: 1; color: var(--accent-green); }
        .gate-verify-step .step-dot {
            width: 16px; height: 16px; border-radius: 50%;
            border: 2px solid var(--text-muted); display: flex;
            align-items: center; justify-content: center; font-size: 9px;
            flex-shrink: 0; transition: all 0.3s;
        }
        .gate-verify-step.active .step-dot { border-color: var(--accent-green); }
        .gate-verify-step.done .step-dot {
            border-color: var(--accent-green); background: var(--accent-green); color: #000;
        }
        .gate-manual-section { transition: opacity 0.3s; }
        .gate-manual-section.hidden { opacity: 0; pointer-events: none; height: 0; overflow: hidden; margin: 0; padding: 0; }

        /* ============================================
           ECOSYSTEM PROCESSING THEATER
        ============================================ */
        .ecosystem-theater {
            position: fixed; inset: 0; background: var(--bg-primary); z-index: 2000;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            padding: 30px; text-align: center;
        }
        .ecosystem-theater.hidden { display: none; }
        .eco-theater-icon { width: 72px; height: 72px; margin-bottom: 28px; position: relative; }
        .eco-theater-ring {
            width: 72px; height: 72px; border: 3px solid rgba(34,197,94,0.15);
            border-top-color: var(--accent-green); border-right-color: var(--accent-gold);
            border-radius: 50%; animation: eco-spin 1s linear infinite;
            position: absolute; top: 0; left: 0;
        }
        .eco-theater-ring-inner {
            width: 52px; height: 52px; border: 2px solid rgba(139,92,246,0.1);
            border-bottom-color: var(--accent-purple);
            border-radius: 50%; animation: eco-spin 1.5s linear infinite reverse;
            position: absolute; top: 10px; left: 10px;
        }
        @keyframes eco-spin { to { transform: rotate(360deg); } }
        .eco-theater-title {
            font-family: 'JetBrains Mono', monospace; font-size: 1.2rem; font-weight: 700;
            color: var(--text-primary); margin-bottom: 6px; min-height: 30px;
            transition: opacity 0.3s ease;
        }
        .eco-theater-step {
            font-size: 0.82rem; color: var(--text-secondary);
            margin-bottom: 28px; min-height: 22px;
            transition: opacity 0.3s ease;
        }
        .eco-theater-progress {
            width: 300px; height: 5px; background: rgba(34,197,94,0.1);
            border-radius: 3px; overflow: hidden; margin-bottom: 8px;
        }
        .eco-theater-progress-fill {
            height: 100%; border-radius: 3px;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-gold));
            background-size: 200% 100%;
            animation: eco-progress-shimmer 2s ease infinite;
            transition: width 0.6s ease; width: 10%;
        }
        @keyframes eco-progress-shimmer {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        .eco-theater-pct {
            font-family: 'JetBrains Mono', monospace; font-size: 0.7rem;
            color: var(--text-muted); margin-bottom: 24px;
        }
        .eco-theater-value-frame {
            max-width: 400px; padding: 16px 24px;
            background: rgba(34,197,94,0.06); border: 1px solid rgba(34,197,94,0.2);
            border-radius: 12px; opacity: 0; transform: translateY(8px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .eco-theater-value-frame.show { opacity: 1; transform: translateY(0); }
        .eco-theater-value-label {
            font-family: 'JetBrains Mono', monospace; font-size: 0.62rem;
            color: var(--text-muted); text-transform: uppercase;
            letter-spacing: 0.12em; margin-bottom: 6px;
        }
        .eco-theater-value-text {
            font-size: 0.85rem; color: var(--accent-green); font-weight: 600; line-height: 1.6;
        }

        /* HEADER */
        .header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 8px; padding-bottom: 20px; border-bottom: 1px solid var(--border);
        }
        .header-left { display: flex; align-items: center; gap: 15px; }
        .logo {
            font-family: 'JetBrains Mono', monospace; font-size: 0.75rem;
            font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em;
            color: var(--text-secondary);
        }
        .logo span { color: var(--accent-green); }
        .live-indicator {
            display: flex; align-items: center; gap: 6px; padding: 5px 12px;
            background: var(--accent-green-dim); border: 1px solid rgba(34, 197, 94, 0.3);
            border-radius: 50px; font-size: 0.7rem; font-weight: 600;
            color: var(--accent-green); text-transform: uppercase; letter-spacing: 0.05em;
        }
        .live-dot {
            width: 6px; height: 6px; background: var(--accent-green);
            border-radius: 50%; animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(0.8); }
        }
        .architect-badge {
            display: flex; align-items: center; gap: 8px; padding: 8px 14px;
            background: var(--bg-card); border: 1px solid var(--border);
            border-radius: 8px; font-family: 'JetBrains Mono', monospace;
            font-size: 0.8rem; font-weight: 600; color: var(--accent-gold);
            cursor: pointer; transition: all 0.2s;
        }
        .architect-badge:hover {
            border-color: var(--accent-gold); background: var(--accent-gold-dim);
        }

        /* FIX 3: Dashboard brand attribution line */
        .dashboard-brand-line {
            text-align: center; padding: 6px 0 18px;
        }
        .dashboard-brand-line span {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.6rem; font-weight: 600;
            color: rgba(34, 197, 94, 0.4);
            letter-spacing: 0.08em;
        }

        /* WELCOME BANNER */
        .welcome-banner {
            display: none; position: relative; overflow: hidden;
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.12) 0%, rgba(251, 191, 36, 0.08) 100%);
            border: 1px solid rgba(139, 92, 246, 0.35);
            border-radius: 14px; padding: 18px 20px; margin-bottom: 20px;
        }
        .welcome-banner.show { display: flex; align-items: center; gap: 16px; }
        .welcome-banner::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.04), transparent);
            animation: shimmer 4s infinite;
        }
        .welcome-banner-icon { font-size: 1.8rem; flex-shrink: 0; position: relative; z-index: 1; }
        .welcome-banner-content { flex: 1; position: relative; z-index: 1; }
        .welcome-banner-title {
            font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; font-weight: 700;
            text-transform: uppercase; letter-spacing: 0.08em; color: var(--accent-purple); margin-bottom: 4px;
        }
        .welcome-banner-desc { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.5; }
        .welcome-banner-desc strong { color: var(--text-primary); }
        .welcome-banner-btn {
            flex-shrink: 0; position: relative; z-index: 1;
            display: inline-flex; align-items: center; gap: 6px; padding: 10px 18px;
            background: var(--accent-purple); color: #fff; border: none; border-radius: 8px;
            font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; font-weight: 700;
            cursor: pointer; transition: all 0.2s; text-decoration: none; white-space: nowrap;
        }
        .welcome-banner-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(139, 92, 246, 0.4); }
        @media (max-width: 700px) {
            .welcome-banner.show { flex-direction: column; text-align: center; }
            .welcome-banner-btn { width: 100%; justify-content: center; }
        }

        /* HERO STATS */
        .hero-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 25px; }
        .hero-stat {
            background: var(--bg-card); border: 1px solid var(--border);
            border-radius: 16px; padding: 20px 16px; text-align: center;
            position: relative; overflow: hidden; transition: all 0.3s;
        }
        .hero-stat:hover { border-color: var(--border-active); transform: translateY(-2px); }
        .hero-stat.primary {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, var(--bg-card) 100%);
            border-color: rgba(34, 197, 94, 0.3);
        }
        .hero-stat.gold {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, var(--bg-card) 100%);
            border-color: rgba(251, 191, 36, 0.3);
        }
        .hero-stat.clickable { cursor: pointer; }
        .hero-stat-label {
            font-size: 0.65rem; font-weight: 600; text-transform: uppercase;
            letter-spacing: 0.1em; color: var(--text-muted); margin-bottom: 6px;
        }
        .hero-stat-value {
            font-family: 'JetBrains Mono', monospace; font-size: 1.5rem;
            font-weight: 800; color: var(--text-primary); line-height: 1;
        }
        .hero-stat.primary .hero-stat-value { color: var(--accent-green); }
        .hero-stat.gold .hero-stat-value { color: var(--accent-gold); }
        .hero-stat-sub { font-size: 0.65rem; color: var(--text-secondary); margin-top: 5px; }
        .hero-stat-cta { font-size: 0.6rem; color: var(--accent-green); margin-top: 3px; }

        /* VELOCITY SECTION */
        .velocity-section {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, var(--bg-card) 100%);
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 16px; padding: 20px; margin-bottom: 25px;
            display: flex; align-items: center; justify-content: space-between;
        }
        .velocity-left { display: flex; align-items: center; gap: 15px; }
        .velocity-icon { font-size: 2rem; }
        .velocity-info h3 { font-size: 0.9rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
        .velocity-info p { font-size: 0.75rem; color: var(--text-secondary); }
        .velocity-score {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.8rem; font-weight: 800; color: var(--accent-purple);
        }

        /* LEVEL SECTION */
        .level-section {
            background: var(--bg-card); border: 1px solid var(--border);
            border-radius: 16px; padding: 20px; margin-bottom: 25px;
        }
        .level-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
        .level-title { font-size: 0.8rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-secondary); }
        .level-badge {
            display: flex; align-items: center; gap: 6px; padding: 5px 12px;
            border-radius: 50px; font-size: 0.7rem; font-weight: 700;
            text-transform: uppercase; letter-spacing: 0.05em;
        }
        .level-badge.bronze { background: linear-gradient(135deg, #92400e, #78350f); color: #fbbf24; }
        .level-badge.silver { background: linear-gradient(135deg, #374151, #1f2937); color: #e5e7eb; }
        .level-badge.gold { background: linear-gradient(135deg, #854d0e, #713f12); color: #fef08a; }
        .level-badge.elite { background: linear-gradient(135deg, #166534, #14532d); color: #86efac; }
        .level-progress { width: 100%; height: 8px; background: var(--bg-secondary); border-radius: 10px; overflow: hidden; margin-bottom: 10px; }
        .level-progress-bar { height: 100%; border-radius: 10px; transition: width 1s ease; }
        .level-progress-bar.bronze { background: linear-gradient(90deg, #92400e, #fbbf24); }
        .level-progress-bar.silver { background: linear-gradient(90deg, #6b7280, #e5e7eb); }
        .level-progress-bar.gold { background: linear-gradient(90deg, #854d0e, #fef08a); }
        .level-progress-bar.elite { background: linear-gradient(90deg, #166534, #22c55e); }
        .level-info { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--text-muted); }
        .level-info span:last-child { color: var(--accent-green); font-weight: 600; }

        /* SYSTEMS GRID */
        .systems-section { margin-bottom: 25px; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
        .section-title { font-size: 0.8rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; color: var(--text-secondary); }
        .section-count {
            font-family: 'JetBrains Mono', monospace; font-size: 0.7rem;
            padding: 4px 10px; background: var(--accent-green-dim);
            border-radius: 20px; color: var(--accent-green); font-weight: 600;
        }
        .systems-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
        
        .system-card {
            display: flex; align-items: center; gap: 12px; padding: 16px;
            background: var(--bg-card); border: 1px solid var(--border);
            border-radius: 12px; cursor: pointer; transition: all 0.2s; text-decoration: none;
            position: relative; overflow: hidden;
        }
        .system-card:hover { border-color: var(--border-active); background: var(--bg-card-hover); transform: translateX(3px); }
        .system-card.completed { border-color: rgba(34, 197, 94, 0.3); }
        .system-card.completed:hover { border-color: var(--accent-green); }
        .system-card.locked { opacity: 0.6; cursor: pointer; border-style: dashed; }
        .system-card.locked:hover { transform: none; background: var(--bg-card); opacity: 0.8; }
        .system-card.locked .system-icon { filter: grayscale(1); }

        .system-card.social-action { position: relative; }
        .system-card.social-action.dm-unlock {
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.08) 0%, var(--bg-card) 100%);
            border-color: rgba(236, 72, 153, 0.3); border-style: solid;
        }
        .system-card.social-action.dm-unlock:hover { border-color: var(--accent-pink); box-shadow: 0 0 25px var(--accent-pink-glow); }
        .system-card.social-action.story-unlock {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.08) 0%, var(--bg-card) 100%);
            border-color: rgba(251, 191, 36, 0.3); border-style: solid;
        }
        .system-card.social-action.story-unlock:hover { border-color: var(--accent-gold); box-shadow: 0 0 25px var(--accent-gold-glow); }
        .system-card.social-action.locked::before {
            content: ''; position: absolute; inset: -2px; border-radius: 14px; padding: 2px;
            background: linear-gradient(90deg, transparent, rgba(236, 72, 153, 0.3), transparent);
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor; mask-composite: exclude; animation: social-pulse 2s ease-in-out infinite;
        }
        .system-card.social-action.story-unlock.locked::before { background: linear-gradient(90deg, transparent, rgba(251, 191, 36, 0.3), transparent); }
        @keyframes social-pulse { 0%, 100% { opacity: 0.5; } 50% { opacity: 1; } }

        .action-badge {
            position: absolute; top: 8px; right: 8px; padding: 3px 8px;
            border-radius: 20px; font-size: 0.55rem; font-weight: 700;
            text-transform: uppercase; letter-spacing: 0.05em; animation: badge-pulse 2s ease-in-out infinite;
        }
        .action-badge.dm { background: var(--accent-pink); color: white; }
        .action-badge.story { background: var(--accent-gold); color: #000; }
        @keyframes badge-pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        .system-icon {
            width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;
            background: var(--bg-secondary); border-radius: 10px; font-size: 1.2rem; flex-shrink: 0;
        }
        .system-card.completed .system-icon { background: var(--accent-green-dim); }
        .system-card.social-action.dm-unlock .system-icon { background: var(--accent-pink-dim); }
        .system-card.social-action.story-unlock .system-icon { background: var(--accent-gold-dim); }
        
        .system-info { flex: 1; min-width: 0; }
        .system-name { font-size: 0.85rem; font-weight: 700; color: var(--text-primary); margin-bottom: 2px; }
        .system-desc { font-size: 0.7rem; color: var(--text-muted); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .system-desc.completed-context { color: var(--accent-green); font-family: 'JetBrains Mono', monospace; font-size: 0.65rem; font-weight: 600; }
        .system-status { font-size: 1.2rem; }

        /* NEXT ACTION */
        .next-action {
            background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, var(--bg-card) 100%);
            border: 2px solid var(--accent-green); border-radius: 16px;
            padding: 22px; margin-bottom: 25px; position: relative; overflow: hidden;
        }
        .next-action::before {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(34, 197, 94, 0.05), transparent);
            animation: shimmer 3s infinite;
        }
        @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }
        .next-action-badge {
            display: inline-flex; align-items: center; gap: 6px; padding: 4px 10px;
            background: var(--accent-green); color: #000; border-radius: 50px;
            font-size: 0.6rem; font-weight: 800; text-transform: uppercase;
            letter-spacing: 0.1em; margin-bottom: 12px;
        }
        .next-action-title { font-size: 1.1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 6px; }
        .next-action-desc { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.5; margin-bottom: 16px; }
        .next-action-btn {
            display: inline-flex; align-items: center; gap: 10px; padding: 12px 24px;
            background: var(--accent-green); color: #000; border: none; border-radius: 10px;
            font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; font-weight: 700;
            text-decoration: none; cursor: pointer; transition: all 0.2s; position: relative; z-index: 1;
        }
        .next-action-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px var(--accent-green-glow); }
        .next-action.level-up { border-color: var(--accent-gold); background: linear-gradient(135deg, rgba(251,191,36,0.1) 0%, var(--bg-card) 100%); }
        .next-action.level-up .next-action-badge { background: var(--accent-gold); }
        .next-action.level-up .next-action-btn { background: var(--accent-gold); }

        /* SHARE SECTION */
        .share-section {
            background: var(--bg-card); border: 1px solid var(--border);
            border-radius: 16px; padding: 20px; text-align: center;
        }
        .share-title { font-size: 0.8rem; font-weight: 700; color: var(--text-secondary); margin-bottom: 5px; }
        .share-subtitle { font-size: 0.75rem; color: var(--text-muted); margin-bottom: 15px; }
        .share-buttons { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; }
        .share-btn {
            display: flex; align-items: center; gap: 6px; padding: 10px 16px;
            background: var(--bg-secondary); border: 1px solid var(--border);
            border-radius: 8px; color: var(--text-secondary); font-size: 0.75rem;
            font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none;
        }
        .share-btn:hover { border-color: var(--accent-green); color: var(--accent-green); background: var(--accent-green-dim); }

        /* GENERIC INFO MODAL */
        .info-modal {
            position: fixed; inset: 0; background: rgba(5, 5, 5, 0.95);
            backdrop-filter: blur(10px); z-index: 1000; display: none;
            flex-direction: column; align-items: center; justify-content: center; padding: 20px;
        }
        .info-modal.show { display: flex; }
        .info-modal-card {
            background: var(--bg-card); border: 2px solid var(--accent-green);
            border-radius: 20px; padding: 35px; max-width: 450px; width: 100%; text-align: center;
            animation: modalReveal 0.3s ease; max-height: 90vh; overflow-y: auto;
        }
        @keyframes modalReveal { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
        .info-modal-card.pink { border-color: var(--accent-pink); }
        .info-modal-card.gold { border-color: var(--accent-gold); }
        .info-modal-icon { font-size: 3rem; margin-bottom: 15px; }
        .info-modal-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 8px; }
        .info-modal-subtitle { font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 20px; line-height: 1.5; }
        
        .unlock-method { background: var(--bg-secondary); border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: left; }
        .unlock-method-title { font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent-green); margin-bottom: 12px; display: flex; align-items: center; gap: 8px; }
        .unlock-method-title.pink { color: var(--accent-pink); }
        .unlock-method-title.gold { color: var(--accent-gold); }
        .unlock-step { display: flex; align-items: flex-start; gap: 12px; padding: 10px 0; border-bottom: 1px solid var(--border); }
        .unlock-step:last-child { border-bottom: none; }
        .unlock-step-num { width: 22px; height: 22px; background: var(--accent-green); color: #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 0.7rem; font-weight: 800; flex-shrink: 0; }
        .unlock-step-num.pink { background: var(--accent-pink); }
        .unlock-step-num.gold { background: var(--accent-gold); }
        .unlock-step-text { font-size: 0.85rem; color: var(--text-secondary); line-height: 1.4; }
        .unlock-step-text strong { color: var(--text-primary); }
        
        .secret-keyword-box { background: linear-gradient(135deg, rgba(236, 72, 153, 0.15), rgba(139, 92, 246, 0.15)); border: 2px dashed rgba(236, 72, 153, 0.5); border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .secret-keyword-label { font-size: 0.65rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.15em; color: var(--accent-pink); margin-bottom: 8px; }
        .secret-keyword { font-family: 'JetBrains Mono', monospace; font-size: 1.8rem; font-weight: 800; color: var(--text-primary); letter-spacing: 0.1em; }
        
        .code-input-group { margin-bottom: 18px; }
        .code-input { width: 100%; padding: 14px; background: var(--bg-secondary); border: 2px solid var(--border); border-radius: 10px; color: var(--text-primary); font-family: 'JetBrains Mono', monospace; font-size: 1.1rem; font-weight: 700; text-align: center; letter-spacing: 0.15em; text-transform: uppercase; transition: border-color 0.2s; }
        .code-input:focus { outline: none; border-color: var(--accent-pink); }
        .code-input::placeholder { color: var(--text-muted); letter-spacing: normal; font-size: 0.85rem; }
        .code-error { color: var(--danger); font-size: 0.75rem; margin-top: 6px; display: none; }
        
        .info-modal-btns { display: flex; gap: 10px; flex-direction: column; }
        .info-modal-btn { padding: 14px; border-radius: 10px; font-size: 0.9rem; font-weight: 700; cursor: pointer; transition: all 0.2s; text-decoration: none; display: flex; align-items: center; justify-content: center; gap: 8px; border: none; }
        .info-modal-btn.primary { background: var(--accent-green); color: #000; }
        .info-modal-btn.primary.pink { background: linear-gradient(135deg, var(--accent-pink), var(--accent-purple)); color: #fff; }
        .info-modal-btn.primary.gold { background: linear-gradient(135deg, var(--accent-gold), #f59e0b); color: #000; }
        .info-modal-btn.primary:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(34, 197, 94, 0.4); }
        .info-modal-btn.secondary { background: transparent; color: var(--text-secondary); border: 2px solid var(--border); }

        .dual-options { display: flex; gap: 12px; margin-bottom: 18px; }
        .dual-option { flex: 1; background: var(--bg-secondary); border: 2px solid var(--border); border-radius: 12px; padding: 16px 12px; text-align: center; cursor: pointer; transition: all 0.2s; }
        .dual-option:hover { border-color: var(--accent-green); }
        .dual-option.selected { border-color: var(--accent-gold); background: rgba(251, 191, 36, 0.1); }
        .dual-option-icon { font-size: 1.5rem; margin-bottom: 8px; }
        .dual-option-title { font-size: 0.8rem; font-weight: 700; color: var(--text-primary); margin-bottom: 3px; }
        .dual-option-desc { font-size: 0.65rem; color: var(--text-muted); }
        .dual-section { display: none; }
        .dual-section.show { display: block; }

        .share-modal-content { text-align: center; }
        .share-card-preview {
            background: linear-gradient(135deg, rgba(34,197,94,0.15) 0%, var(--bg-secondary) 100%);
            border: 2px solid rgba(34,197,94,0.3); border-radius: 16px; padding: 25px; margin-bottom: 20px;
        }
        .share-card-id { font-family: 'JetBrains Mono', monospace; font-size: 1.4rem; font-weight: 800; color: var(--accent-green); margin-bottom: 8px; }
        .share-card-stats { font-family: 'JetBrains Mono', monospace; font-size: 1rem; font-weight: 700; color: var(--text-primary); margin-bottom: 4px; }
        .share-card-level { font-size: 0.8rem; color: var(--accent-gold); font-weight: 700; margin-bottom: 12px; }
        .share-card-brand { font-size: 0.7rem; color: var(--text-muted); }
        .share-instructions { font-size: 0.8rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 15px; }

        /* === STANDARDIZED FOOTER === */
        .site-footer {
            margin-top: 35px; padding-top: 18px; border-top: 1px solid var(--border); text-align: center;
        }
        .site-footer a { color: var(--accent-green); text-decoration: none; font-size: 0.75rem; font-weight: 600; }
        .site-footer .footer-copy {
            font-size: 0.65rem; color: var(--text-muted); margin-top: 8px;
        }

        .all-complete {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.1) 0%, var(--bg-card) 100%);
            border: 2px solid var(--accent-gold); border-radius: 16px;
            padding: 25px; text-align: center; margin-bottom: 25px;
        }
        .all-complete-icon { font-size: 2.5rem; margin-bottom: 12px; }
        .all-complete-title { font-size: 1.2rem; font-weight: 800; color: var(--accent-gold); margin-bottom: 6px; }
        .all-complete-desc { font-size: 0.85rem; color: var(--text-secondary); }

        @media (max-width: 700px) {
            .hero-stats { grid-template-columns: repeat(3, 1fr); gap: 8px; }
            .hero-stat { padding: 12px 8px; }
            .hero-stat-value { font-size: 1.1rem; }
            .hero-stat-sub { display: none; }
            .hero-stat-cta { display: none; }
            .systems-grid { grid-template-columns: 1fr; }
            .header { flex-direction: column; gap: 15px; text-align: center; }
            .header-left { flex-direction: column; }
            .share-buttons { flex-direction: column; }
            .share-btn { justify-content: center; }
            .dual-options { flex-direction: column; }
            .velocity-section { flex-direction: column; gap: 15px; text-align: center; }
        }
    </style>
</head>
<body>
    <div class="bg-grid"></div>
    <div class="bg-glow bg-glow-1"></div>
    <div class="bg-glow bg-glow-2"></div>

    <!-- ACCESS GATE (cold IG traffic only) -->
    <div class="access-gate" id="accessGate">
        <div class="gate-preview" id="gatePreview" aria-hidden="true">
            <div class="gp-header">
                <div class="gp-logo">COMMAND <span>CENTER</span></div>
                <div class="gp-badge">&#x1F3DB;&#xFE0F; KOU-A7X9R2</div>
            </div>
            <div class="gp-stats">
                <div class="gp-stat green"><div class="gp-stat-val">4/7</div><div class="gp-stat-label">Tools Active</div></div>
                <div class="gp-stat"><div class="gp-stat-val">2031</div><div class="gp-stat-label">Freedom Year</div></div>
                <div class="gp-stat gold"><div class="gp-stat-val">47</div><div class="gp-stat-label">Days Building</div></div>
            </div>
            <div class="gp-velocity">
                <div class="gp-velocity-label">&#9889; Wealth Velocity</div>
                <div class="gp-velocity-score">1.5x</div>
            </div>
            <div class="gp-level">
                <div style="display:flex; justify-content:space-between; font-size:0.75rem;">
                    <span style="color:var(--text-secondary);">Architect Level</span>
                    <span style="color:var(--accent-gold); font-weight:700;">Silver</span>
                </div>
                <div class="gp-level-bar"><div class="gp-level-fill"></div></div>
            </div>
            <div class="gp-grid">
                <div class="gp-card done"><div class="gp-card-icon">&#x1F916;</div><div class="gp-card-text">Autopilot System</div><div class="gp-card-status">&#x2705;</div></div>
                <div class="gp-card done"><div class="gp-card-icon">&#x1F3AF;</div><div class="gp-card-text">Freedom Calculator</div><div class="gp-card-status">&#x2705;</div></div>
                <div class="gp-card done"><div class="gp-card-icon">&#x23F0;</div><div class="gp-card-text">Cost of Waiting</div><div class="gp-card-status">&#x2705;</div></div>
                <div class="gp-card done"><div class="gp-card-icon">&#x1F4CA;</div><div class="gp-card-text">Investment Simplifier</div><div class="gp-card-status">&#x2705;</div></div>
                <div class="gp-card"><div class="gp-card-icon">&#x1F4B3;</div><div class="gp-card-text">800-Club Protocol</div><div class="gp-card-status">&#x25CB;</div></div>
                <div class="gp-card"><div class="gp-card-icon">&#x1F4B0;</div><div class="gp-card-text">Budget Calculator</div><div class="gp-card-status">&#x1F512;</div></div>
            </div>
        </div>

        <div class="gate-overlay" id="gateOverlay">
            <div class="gate-content" id="gateContent">
                <div class="gate-brand">
                    <div class="gate-brand-dot"></div>
                    <span>@koutalksmoney</span>
                </div>
                <h1 class="gate-title">Command Center</h1>
                <div class="gate-hook">
                    <strong>7 tools.</strong> One machine.<br>Zero willpower.
                </div>
                <div class="gate-proof" id="gateProof">
                    <div class="gate-proof-dot"></div>
                    <span id="gateProofText">47 Architects building</span>
                </div>
                <div class="gate-pillars">
                    <div class="gate-pillar"><div class="gate-pillar-icon">&#x1F916;</div><div class="gate-pillar-name">Automate</div></div>
                    <div class="gate-pillar"><div class="gate-pillar-icon">&#x1F4CA;</div><div class="gate-pillar-name">Invest</div></div>
                    <div class="gate-pillar"><div class="gate-pillar-icon">&#x1F4B3;</div><div class="gate-pillar-name">Credit</div></div>
                    <div class="gate-pillar"><div class="gate-pillar-icon">&#x1F3AF;</div><div class="gate-pillar-name">Freedom #</div></div>
                    <div class="gate-pillar"><div class="gate-pillar-icon">&#x1F4B0;</div><div class="gate-pillar-name">Cash Flow</div></div>
                    <div class="gate-pillar"><div class="gate-pillar-icon">&#x1F9E0;</div><div class="gate-pillar-name">AI Vault</div></div>
                </div>
                <a href="https://spacekou5-oss.github.io/cashvault-funnel/autopilot-system.html" class="gate-cta" id="gateCta">Start The System &#8594;</a>
                <div class="gate-divider">Already have an Architect ID?</div>
                <div class="gate-id-section">
                    <div class="gate-id-label">Enter your Architect ID</div>
                    <div class="gate-id-input-wrapper">
                        <input type="text" id="gateIdInput" class="gate-id-input" placeholder="KOU-XXXXXX" maxlength="10" autocomplete="off">
                        <button class="gate-id-btn" onclick="gateManualEntry()">Enter</button>
                    </div>
                    <p class="gate-error" id="gateError">Invalid ID format. Must be KOU- followed by 6 characters.</p>
                </div>
                <div class="gate-footer">
                    <a href="https://instagram.com/koutalksmoney" target="_blank">@koutalksmoney</a>
                    <p class="gate-footer-copy">Built by Kou Talks Money. 2026. All rights reserved.</p>
                </div>
            </div>

            <div class="gate-verify-state" id="gateVerifyState">
                <div class="gate-verify-id" id="gateVerifyId">KOU-XXXXXX</div>
                <div class="gate-verify-progress">
                    <div class="gate-verify-bar" id="gateVerifyBar"></div>
                </div>
                <div class="gate-verify-status" id="gateVerifyStatus">Initializing...</div>
                <div class="gate-verify-check">
                    <div class="gate-verify-step" id="gvStep1">
                        <div class="step-dot"></div>
                        <span>Verifying Architect ID</span>
                    </div>
                    <div class="gate-verify-step" id="gvStep2">
                        <div class="step-dot"></div>
                        <span>Loading your systems</span>
                    </div>
                    <div class="gate-verify-step" id="gvStep3">
                        <div class="step-dot"></div>
                        <span>Preparing dashboard</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ECOSYSTEM PROCESSING THEATER -->
    <div class="ecosystem-theater hidden" id="ecosystemTheater">
        <div class="eco-theater-icon">
            <div class="eco-theater-ring"></div>
            <div class="eco-theater-ring-inner"></div>
        </div>
        <p class="eco-theater-title" id="ecoTheaterTitle">Scanning ecosystem...</p>
        <p class="eco-theater-step" id="ecoTheaterStep">Checking for active tools...</p>
        <div class="eco-theater-progress"><div class="eco-theater-progress-fill" id="ecoTheaterProgressFill"></div></div>
        <p class="eco-theater-pct" id="ecoTheaterPct">10%</p>
        <div class="eco-theater-value-frame" id="ecoTheaterValueFrame">
            <p class="eco-theater-value-label">Detected</p>
            <p class="eco-theater-value-text" id="ecoTheaterValueText"></p>
        </div>
    </div>

    <!-- UNIVERSAL INFO MODAL -->
    <div class="info-modal" id="infoModal">
        <div class="info-modal-card" id="infoModalCard">
            <div class="info-modal-icon" id="infoModalIcon">&#x1F512;</div>
            <h2 class="info-modal-title" id="infoModalTitle">System Locked</h2>
            <p class="info-modal-subtitle" id="infoModalSubtitle">Complete the required steps to unlock</p>
            <div id="infoModalContent"></div>
            <div class="info-modal-btns">
                <button class="info-modal-btn primary" id="infoModalPrimaryBtn" onclick="handleInfoModalAction()">Continue</button>
                <button class="info-modal-btn secondary" onclick="closeInfoModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- BUDGET CODE MODAL -->
    <div class="info-modal" id="budgetCodeModal">
        <div class="info-modal-card pink">
            <div class="info-modal-icon">&#x1F511;</div>
            <h2 class="info-modal-title">Enter Unlock Code</h2>
            <p class="info-modal-subtitle">DM the secret keyword to @koutalksmoney to receive your code</p>
            <div class="code-input-group">
                <input type="text" id="budgetCodeInput" class="code-input" placeholder="Enter code here" maxlength="12">
                <p class="code-error" id="budgetCodeError">Invalid code. DM "INNERLOOP" to get the correct code.</p>
            </div>
            <div class="info-modal-btns">
                <button class="info-modal-btn primary pink" onclick="verifyBudgetCode()">&#x1F513; Unlock</button>
                <button class="info-modal-btn secondary" onclick="closeBudgetCodeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- VAULT CODE MODAL -->
    <div class="info-modal" id="vaultCodeModal">
        <div class="info-modal-card gold">
            <div class="info-modal-icon">&#x1F511;</div>
            <h2 class="info-modal-title">Enter Vault Code</h2>
            <p class="info-modal-subtitle">Post your Architect Certificate on your Instagram Story, tag @koutalksmoney, and I'll DM you the code!</p>
            <div class="code-input-group">
                <input type="text" id="vaultCodeInput" class="code-input" placeholder="Enter code here" maxlength="12">
                <p class="code-error" id="vaultCodeError">Invalid code. Post your certificate to your story and tag me to get the correct code.</p>
            </div>
            <div class="info-modal-btns">
                <button class="info-modal-btn primary gold" onclick="verifyVaultCode()">&#x1F513; Unlock Vault</button>
                <button class="info-modal-btn secondary" onclick="closeVaultCodeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <!-- SHARE MODAL -->
    <div class="info-modal" id="shareModal">
        <div class="info-modal-card">
            <div class="share-modal-content">
                <div class="info-modal-icon">&#x1F4F8;</div>
                <h2 class="info-modal-title">Share Your Progress</h2>
                <div class="share-card-preview" id="shareCardPreview">
                    <div class="share-card-id" id="shareCardId">KOU-XXXXXX</div>
                    <div class="share-card-stats" id="shareCardStats">0/7 Systems Active</div>
                    <div class="share-card-level" id="shareCardLevel">Bronze Architect</div>
                    <div class="share-card-brand">@koutalksmoney</div>
                </div>
                <p class="share-instructions">Screenshot this card, post it to your Instagram Story, and tag <strong>@koutalksmoney</strong> to show your progress.</p>
            </div>
            <div class="info-modal-btns">
                <a href="https://instagram.com/koutalksmoney" target="_blank" class="info-modal-btn primary">Open Instagram &#8594;</a>
                <button class="info-modal-btn secondary" onclick="closeShareModal()">Close</button>
            </div>
        </div>
    </div>

    <!-- MAIN DASHBOARD -->
    <div class="container" id="mainDashboard" style="display:none;">
        <div class="header">
            <div class="header-left">
                <div class="logo">COMMAND <span>CENTER</span></div>
                <div class="live-indicator"><div class="live-dot"></div><span>Live</span></div>
            </div>
            <div class="architect-badge" onclick="copyArchitectId()">
                <span>&#x1F3DB;&#xFE0F;</span>
                <span id="displayArchitectId">KOU-XXXXXX</span>
            </div>
        </div>

        <!-- FIX 3: Brand attribution in dashboard screenshot zone -->
        <div class="dashboard-brand-line">
            <span>@koutalksmoney</span>
        </div>

        <div class="welcome-banner" id="welcomeBanner">
            <div class="welcome-banner-icon">&#x26A1;</div>
            <div class="welcome-banner-content">
                <div class="welcome-banner-title" id="welcomeBannerTitle">System Online</div>
                <div class="welcome-banner-desc" id="welcomeBannerDesc">Loading next directive...</div>
            </div>
            <a href="#" class="welcome-banner-btn" id="welcomeBannerBtn"><span id="welcomeBannerBtnText">Next Tool</span> <span>&rarr;</span></a>
        </div>

        <div class="hero-stats">
            <div class="hero-stat primary">
                <div class="hero-stat-label">Tools Active</div>
                <div class="hero-stat-value" id="systemsCompleted">0/7</div>
                <div class="hero-stat-sub">Keep building</div>
            </div>
            <div class="hero-stat clickable" id="freedomStat" onclick="goToFreedomCalc()">
                <div class="hero-stat-label">Freedom Year</div>
                <div class="hero-stat-value" id="freedomDate">&mdash;</div>
                <div class="hero-stat-sub" id="freedomSub">Your target</div>
                <div class="hero-stat-cta" id="freedomCta">Calculate &rarr;</div>
            </div>
            <div class="hero-stat gold">
                <div class="hero-stat-label">Days Building</div>
                <div class="hero-stat-value" id="daysBuilding">1</div>
                <div class="hero-stat-sub">Your streak</div>
            </div>
        </div>

        <div class="velocity-section" id="velocitySection">
            <div class="velocity-left">
                <div class="velocity-icon">&#9889;</div>
                <div class="velocity-info">
                    <h3>Wealth Velocity</h3>
                    <p id="velocityDesc">Complete more tools to accelerate</p>
                </div>
            </div>
            <div class="velocity-score" id="velocityScore">1.0x</div>
        </div>

        <div class="level-section">
            <div class="level-header">
                <span class="level-title">Architect Level</span>
                <span class="level-badge bronze" id="levelBadge"><span>&#11088;</span><span id="levelName">Bronze</span></span>
            </div>
            <div class="level-progress">
                <div class="level-progress-bar bronze" id="levelProgressBar" style="width: 0%;"></div>
            </div>
            <div class="level-info">
                <span id="levelCurrentXp">0 / 7 systems</span>
                <span id="levelNextReward">3 more &rarr; Silver</span>
            </div>
        </div>

        <div class="next-action" id="nextAction">
            <div class="next-action-badge"><span>&#9889;</span><span>Next Step</span></div>
            <h3 class="next-action-title" id="nextActionTitle">Start Building</h3>
            <p class="next-action-desc" id="nextActionDesc">Begin with the Autopilot System.</p>
            <a href="#" class="next-action-btn" id="nextActionBtn"><span id="nextActionBtnText">Continue</span><span>&rarr;</span></a>
        </div>

        <div class="all-complete" id="allComplete" style="display: none;">
            <div class="all-complete-icon">&#128081;</div>
            <h3 class="all-complete-title">ELITE ARCHITECT</h3>
            <p class="all-complete-desc">All tools operational. Maximum velocity achieved.</p>
        </div>

        <div class="systems-section">
            <div class="section-header">
                <span class="section-title">Your Tools</span>
                <span class="section-count" id="systemsCount">0/7</span>
            </div>
            <p style="font-size:0.75rem; color:var(--text-muted); margin:-8px 0 14px; line-height:1.4;">Each tool builds one piece of your wealth machine. Complete them all to reach Elite.</p>
            <div class="systems-grid" id="systemsGrid"></div>
        </div>

        <div class="share-section">
            <h3 class="share-title">Share Progress</h3>
            <p class="share-subtitle">Building while they're sleeping</p>
            <div class="share-buttons">
                <a href="#" class="share-btn" onclick="shareToInstagram(); return false;"><span>&#x1F4F8;</span><span>Story</span></a>
                <a href="#" class="share-btn" onclick="shareToTwitter(); return false;"><span>&#x1D54F;</span><span>Post</span></a>
                <button class="share-btn" onclick="copyShareText()"><span>&#x1F4CB;</span><span>Copy</span></button>
            </div>
        </div>

        <!-- FIX 2: Standardized footer -->
        <footer class="site-footer">
            <a href="https://instagram.com/koutalksmoney" target="_blank">@koutalksmoney</a>
            <p class="footer-copy">Built by Kou Talks Money. 2026. All rights reserved.</p>
        </footer>
    </div>

    <script>
        /* ================================================
           CELEBRATION PARTICLES (FIX 1)
           Fires on successful sign-in from any path.
           Multi-shape burst from center of screen.
           ================================================ */
        function triggerCelebration() {
            var container = document.createElement('div');
            container.className = 'celebration-container';
            document.body.appendChild(container);
            var colors = ['#22c55e', '#fbbf24', '#8b5cf6', '#3b82f6', '#ec4899', '#10b981'];
            var cx = window.innerWidth / 2;
            var cy = window.innerHeight / 3;

            for (var i = 0; i < 50; i++) {
                (function(idx) {
                    setTimeout(function() {
                        var p = document.createElement('div');
                        p.className = 'c-particle' + (Math.random() > 0.6 ? ' square' : '');
                        p.style.left = cx + 'px';
                        p.style.top = cy + 'px';
                        p.style.background = colors[Math.floor(Math.random() * colors.length)];
                        var size = (Math.random() * 10 + 4) + 'px';
                        p.style.width = size;
                        p.style.height = size;
                        var angle = Math.random() * Math.PI * 2;
                        var dist = 100 + Math.random() * 250;
                        p.style.setProperty('--tx', Math.cos(angle) * dist + 'px');
                        p.style.setProperty('--ty', (Math.sin(angle) * dist - 60) + 'px');
                        p.style.setProperty('--rot', (Math.random() * 720 - 360) + 'deg');
                        container.appendChild(p);
                    }, idx * 20);
                })(i);
            }
            setTimeout(function() { container.remove(); }, 3000);
        }

        var CONFIG = {
            AUTOPILOT_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/autopilot-system.html',
            FREEDOM_CALCULATOR_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/freedom-calculator.html',
            COST_OF_WAITING_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/cost-of-waiting.html',
            INVESTMENT_SIMPLIFIER_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/Investment-Simplifier.html',
            EIGHT_HUNDRED_CLUB_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/800-club.html',
            BUDGET_CALCULATOR_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/Kous-Budget-Calculator.html',
            PROMPT_VAULT_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/prompt-vault.html',
            COMMAND_CENTER_URL: 'https://spacekou5-oss.github.io/cashvault-funnel/command-center.html',
            INSTAGRAM: 'https://instagram.com/koutalksmoney',
            ARCHITECT_BASE_COUNT: 47
        };

        function updateArchitectCount() {
            var count = CONFIG.ARCHITECT_BASE_COUNT;
            var launchDate = new Date('2025-06-01');
            var now = new Date();
            var daysSinceLaunch = Math.max(0, Math.floor((now - launchDate) / (1000 * 60 * 60 * 24)));
            count = count + Math.floor(daysSinceLaunch * 0.3);
            var el = document.getElementById('gateProofText');
            if (el) el.textContent = count + ' Architects building';
        }

        function simpleHash(str) {
            var hash = 0;
            for (var i = 0; i < str.length; i++) {
                var ch = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + ch;
                hash = hash & hash;
            }
            return hash;
        }
        var BUDGET_HASH = simpleHash('CASHFLOW');
        var VAULT_HASH = simpleHash('CERTIFIED');

        var SYSTEM_CONFIG = {
            'autopilot': { primaryKey: 'autopilot_completed', fallbackKey: 'cashvault_architect_id', logic: function(p, f) { return p === 'true' || !!localStorage.getItem(f); } },
            'freedom': { primaryKey: 'freedom_completed', fallbackKey: 'freedom_calculator_result', logic: function(p, f) { return p === 'true' || !!localStorage.getItem(f); } },
            'waiting': { primaryKey: 'waiting_completed', fallbackKey: 'cost_of_waiting_data', logic: function(p, f) { return p === 'true' || !!localStorage.getItem(f); } },
            'investment': { primaryKey: 'investment_completed', fallbackKey: 'investment_simplifier_completed', logic: function(p, f) { return p === 'true' || localStorage.getItem(f) === 'true'; } },
            '800club': { primaryKey: 'eightclub_completed', fallbackKey: 'credit_protocol_score', logic: function(p, f) { if (p === 'true') return true; var score = parseInt(localStorage.getItem(f) || '0', 10); return !isNaN(score) && score > 0; } },
            'budget': { primaryKey: 'budget_completed', fallbackKey: 'budget_unlocked', logic: function(p, f) { return p === 'true' || localStorage.getItem(f) === 'true'; } },
            'prompt': { primaryKey: 'prompt_completed', fallbackKey: 'vault_saved_prompts', logic: function(p, f) { if (p === 'true') return true; try { var categories = JSON.parse(localStorage.getItem('prompt_vault_categories_used') || '[]'); var savedPrompts = JSON.parse(localStorage.getItem(f) || '[]'); return categories.length >= 3 || savedPrompts.length > 0; } catch(e) { return false; } } }
        };

        function checkSystemCompletion(systemId) {
            var config = SYSTEM_CONFIG[systemId];
            if (!config) return false;
            var primary = localStorage.getItem(config.primaryKey);
            return config.logic(primary, config.fallbackKey);
        }

        function getCompletionContext(systemId) {
            try {
                switch(systemId) {
                    case 'autopilot': var archId = localStorage.getItem('cashvault_architect_id'); return archId ? 'ID: ' + archId : null;
                    case 'freedom': var fData = JSON.parse(localStorage.getItem('freedom_calculator_result') || 'null'); if (fData && fData.exitAge) return 'Freedom Age: ' + fData.exitAge; if (fData && fData.freedomYears) return 'In ' + fData.freedomYears + ' years'; return null;
                    case 'waiting': var wData = JSON.parse(localStorage.getItem('cost_of_waiting_data') || 'null'); if (wData && wData.costPerDay) return 'Cost: $' + Math.round(wData.costPerDay) + '/day'; return null;
                    case 'investment': var iData = JSON.parse(localStorage.getItem('investmentSimplifier_portfolio') || 'null'); if (iData && iData.etf) return 'Portfolio: ' + iData.etf; return null;
                    case '800club': var score = localStorage.getItem('credit_protocol_score'); if (score) return 'Score: ' + score + '%'; return null;
                    case 'budget': var bData = JSON.parse(localStorage.getItem('budget_calculator_result') || 'null'); if (bData && bData.selectedSystem) return 'System: ' + bData.selectedSystem; return null;
                    case 'prompt': var cats = JSON.parse(localStorage.getItem('prompt_vault_categories_used') || '[]'); if (cats.length > 0) return cats.length + ' categories used'; return null;
                }
            } catch(e) {}
            return null;
        }

        var SYSTEMS = [
            { id: 'autopilot', name: 'Autopilot System', desc: 'Your wealth machine', icon: '\uD83E\uDD16', url: CONFIG.AUTOPILOT_URL, storageKey: 'autopilot_completed', unlockType: 'always', priority: 1, socialAction: null, unlockExplanation: { title: 'Always Available', subtitle: 'This is your entry point. Start here.', steps: ['Click to begin the Autopilot System', 'Complete all 6 modules', 'Claim your unique Architect ID'] } },
            { id: 'freedom', name: 'Freedom Calculator', desc: 'Know your number', icon: '\uD83C\uDFAF', url: CONFIG.FREEDOM_CALCULATOR_URL, storageKey: 'freedom_completed', unlockType: 'completion', unlockRequires: 'autopilot', priority: 2, socialAction: null, unlockExplanation: { title: 'Complete Autopilot System', subtitle: "Install your core wealth machine first.", steps: ['Open the Autopilot System', 'Complete all 6 modules', 'Claim your Architect ID', 'Freedom Calculator unlocks automatically'] } },
            { id: 'waiting', name: 'Cost of Waiting', desc: 'Urgency multiplier', icon: '\u23F0', url: CONFIG.COST_OF_WAITING_URL, storageKey: 'waiting_completed', unlockType: 'completion', unlockRequires: 'freedom', priority: 3, socialAction: null, unlockExplanation: { title: 'Complete Freedom Calculator', subtitle: "Know your target before seeing what delays cost you.", steps: ['Open the Freedom Calculator', 'Enter your financial details', 'Get your Freedom Number', 'Cost of Waiting unlocks automatically'] } },
            { id: 'investment', name: 'Investment Simplifier', desc: 'Portfolio builder', icon: '\uD83D\uDCCA', url: CONFIG.INVESTMENT_SIMPLIFIER_URL, storageKey: 'investment_completed', unlockType: 'completion', unlockRequires: 'waiting', priority: 4, socialAction: null, unlockExplanation: { title: 'Complete Cost of Waiting', subtitle: "Now that you feel the urgency, learn HOW to invest.", steps: ['Open Cost of Waiting Calculator', 'See what procrastination costs', 'Get motivated to act', 'Investment Simplifier unlocks automatically'] } },
            { id: '800club', name: '800-Club Protocol', desc: 'Credit leverage', icon: '\uD83D\uDCB3', url: CONFIG.EIGHT_HUNDRED_CLUB_URL, storageKey: 'eightclub_completed', unlockType: 'level', unlockLevel: 'silver', priority: 5, socialAction: null, unlockExplanation: { title: 'Reach Silver Level', subtitle: "Complete 3 tools to reach Silver and unlock credit mastery.", steps: ['Complete any 3 tools', 'Reach Silver Architect level', '800-Club Protocol unlocks automatically'], showProgress: true } },
            { id: 'budget', name: 'Budget Calculator', desc: 'Cash flow control', icon: '\uD83D\uDCB0', url: CONFIG.BUDGET_CALCULATOR_URL, storageKey: 'budget_completed', unlockType: 'code', unlockKey: 'budget_unlocked', priority: 6, socialAction: 'dm', unlockExplanation: { title: 'DM Secret Keyword', subtitle: "Get exclusive access by connecting with me directly.", secretKeyword: 'INNERLOOP', steps: ['DM @koutalksmoney on Instagram', 'Send the secret keyword: INNERLOOP', "I'll reply with your unlock code instantly", 'Enter the code to unlock'], hasCodeInput: true } },
            { id: 'prompt', name: 'Prompt Vault', desc: 'AI arsenal', icon: '\uD83E\uDDE0', url: CONFIG.PROMPT_VAULT_URL, storageKey: 'prompt_completed', unlockType: 'dual', unlockLevel: 'gold', unlockKey: 'vault_unlocked', priority: 7, socialAction: 'story', unlockExplanation: { title: 'Two Ways to Unlock', subtitle: "Choose your path to the AI arsenal.", dualOptions: [{ icon: '\u2B50', title: 'Reach Gold Level', desc: 'Complete 5 tools', steps: ['Complete any 5 tools', 'Reach Gold Architect level', 'Prompt Vault unlocks automatically'] }, { icon: '\uD83D\uDCF8', title: 'Post Certificate', desc: 'Tag me on your story', steps: ['Open Autopilot System', 'Scroll to your Architect Certificate', 'Screenshot the certificate card', '<strong>Post it on your Instagram Story</strong>', '<strong>Tag @koutalksmoney in the story</strong>', "I'll DM you the Vault code!"] }], hasCodeInput: true } }
        ];

        var currentArchitectId = '';
        var completedSystems = [];
        var unlockedSystems = ['autopilot'];
        var currentModalSystem = null;

        function generateTempArchitectId() {
            var chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
            var id = 'KOU-T';
            for (var i = 0; i < 5; i++) id += chars.charAt(Math.floor(Math.random() * chars.length));
            return id;
        }

        function isBridgeUser() { return localStorage.getItem('vault_email_captured') === 'true'; }
        function isTempId(id) { return id && id.length === 10 && id.substring(0, 5) === 'KOU-T'; }

        function hasEcosystemActivity() {
            var flags = [
                'freedom_completed', 'freedom_calculator_result', 'freedom_email',
                'waiting_completed', 'cost_of_waiting_data', 'cost_of_waiting_email',
                'investment_completed', 'investment_simplifier_completed', 'investmentSimplifier_bridge_email',
                'eightclub_completed', 'credit_protocol_score',
                'budget_completed', 'budget_unlocked',
                'prompt_completed', 'prompt_vault_categories_used'
            ];
            for (var i = 0; i < flags.length; i++) {
                var val = localStorage.getItem(flags[i]);
                if (val && val !== 'false' && val !== '0' && val !== 'null' && val !== '[]') return true;
            }
            return false;
        }

        function getEcosystemCompletions() {
            var found = [];
            var checks = [
                { flags: ['freedom_completed', 'freedom_calculator_result', 'freedom_email'], name: 'Freedom Calculator', icon: '\uD83C\uDFAF' },
                { flags: ['waiting_completed', 'cost_of_waiting_data', 'cost_of_waiting_email'], name: 'Cost of Waiting', icon: '\u23F0' },
                { flags: ['investment_completed', 'investment_simplifier_completed', 'investmentSimplifier_bridge_email'], name: 'Investment Simplifier', icon: '\uD83D\uDCCA' },
                { flags: ['eightclub_completed', 'credit_protocol_score'], name: '800-Club Protocol', icon: '\uD83D\uDCB3' },
                { flags: ['budget_completed', 'budget_unlocked'], name: 'Budget Calculator', icon: '\uD83D\uDCB0' },
                { flags: ['prompt_completed'], name: 'Prompt Vault', icon: '\uD83E\uDDE0' }
            ];
            for (var c = 0; c < checks.length; c++) {
                var check = checks[c];
                for (var f = 0; f < check.flags.length; f++) {
                    var val = localStorage.getItem(check.flags[f]);
                    if (val && val !== 'false' && val !== '0' && val !== 'null' && val !== '[]') {
                        found.push({ name: check.name, icon: check.icon });
                        break;
                    }
                }
            }
            return found;
        }

        function runEcosystemTheater(tempId) {
            var gate = document.getElementById('accessGate');
            gate.classList.remove('show');

            var theater = document.getElementById('ecosystemTheater');
            theater.classList.remove('hidden');

            var titleEl = document.getElementById('ecoTheaterTitle');
            var stepEl = document.getElementById('ecoTheaterStep');
            var progressFill = document.getElementById('ecoTheaterProgressFill');
            var pctEl = document.getElementById('ecoTheaterPct');
            var valueFrame = document.getElementById('ecoTheaterValueFrame');
            var valueText = document.getElementById('ecoTheaterValueText');

            var completions = getEcosystemCompletions();
            var count = completions.length;
            var names = '';
            for (var n = 0; n < completions.length; n++) {
                names += completions[n].icon + ' ' + completions[n].name;
                if (n < completions.length - 1) names += ', ';
            }

            var velScore = '1.0x';
            if (count >= 5) velScore = '1.5x';
            else if (count >= 3) velScore = '1.25x';
            else if (count >= 2) velScore = '1.1x';

            var level = 'Bronze';
            if (count >= 7) level = 'Elite';
            else if (count >= 5) level = 'Gold';
            else if (count >= 3) level = 'Silver';

            var steps = [
                { title: 'Scanning ecosystem...', step: 'Checking for active tools...', pct: 20, label: null, value: null },
                { title: 'Found ' + count + ' active tool' + (count !== 1 ? 's' : '') + '.', step: 'Loading completion data...', pct: 45, label: 'Tools Detected', value: names || 'Ecosystem activity detected' },
                { title: 'Calculating Wealth Velocity...', step: 'Analyzing your progress...', pct: 70, label: 'Your Status', value: 'Velocity: ' + velScore + '  |  Level: ' + level + '  |  ' + count + '/7 tools active' },
                { title: 'Assigning Architect ID...', step: 'Generating temporary credentials...', pct: 90, label: 'Your Architect ID', value: tempId + '  (complete Autopilot to claim permanent ID)' },
                { title: 'Dashboard ready.', step: 'Access granted.', pct: 100, label: null, value: null }
            ];

            var i = 0;
            var interval = setInterval(function() {
                if (i < steps.length) {
                    titleEl.textContent = steps[i].title;
                    stepEl.textContent = steps[i].step;
                    progressFill.style.width = steps[i].pct + '%';
                    pctEl.textContent = steps[i].pct + '%';
                    if (steps[i].value) {
                        var labelEl = document.querySelector('.eco-theater-value-label');
                        if (labelEl && steps[i].label) labelEl.textContent = steps[i].label;
                        valueText.textContent = steps[i].value;
                        valueFrame.classList.add('show');
                    } else {
                        valueFrame.classList.remove('show');
                    }
                    i++;
                } else {
                    clearInterval(interval);
                    setTimeout(function() {
                        theater.classList.add('hidden');
                        document.getElementById('mainDashboard').style.display = 'block';
                        triggerCelebration(); /* FIX 1: Celebration on theater complete */
                        initDashboard();
                    }, 500);
                }
            }, 950);
        }

        function runVerificationCeremony(architectId) {
            var gate = document.getElementById('accessGate');
            var gateContent = document.getElementById('gateContent');
            var gatePreview = document.getElementById('gatePreview');
            var verifyState = document.getElementById('gateVerifyState');
            var verifyId = document.getElementById('gateVerifyId');
            var verifyBar = document.getElementById('gateVerifyBar');
            var verifyStatus = document.getElementById('gateVerifyStatus');
            var step1 = document.getElementById('gvStep1');
            var step2 = document.getElementById('gvStep2');
            var step3 = document.getElementById('gvStep3');

            gate.classList.add('show');
            gateContent.style.display = 'none';
            gatePreview.style.display = 'none';
            verifyState.classList.add('show');
            verifyId.textContent = architectId;

            setTimeout(function() { verifyBar.style.width = '33%'; verifyStatus.textContent = 'Verifying Architect ID...'; step1.classList.add('active'); }, 100);
            setTimeout(function() { step1.classList.remove('active'); step1.classList.add('done'); step1.querySelector('.step-dot').textContent = '\u2713'; }, 800);
            setTimeout(function() { verifyBar.style.width = '66%'; verifyStatus.textContent = 'Loading your systems...'; step2.classList.add('active'); }, 900);
            setTimeout(function() { step2.classList.remove('active'); step2.classList.add('done'); step2.querySelector('.step-dot').textContent = '\u2713'; }, 1800);
            setTimeout(function() { verifyBar.style.width = '100%'; verifyStatus.textContent = 'Access granted.'; verifyStatus.style.color = 'var(--accent-green)'; step3.classList.add('active'); }, 1900);
            setTimeout(function() { step3.classList.remove('active'); step3.classList.add('done'); step3.querySelector('.step-dot').textContent = '\u2713'; }, 2400);
            setTimeout(function() {
                gate.classList.remove('show');
                document.getElementById('mainDashboard').style.display = 'block';
                triggerCelebration(); /* FIX 1: Celebration on ceremony complete */
                initDashboard();
            }, 2700);
        }

        function checkAccess() {
            var urlParams = new URLSearchParams(window.location.search);
            var paramId = urlParams.get('id');
            if (paramId) {
                paramId = paramId.trim().toUpperCase();
                if (/^KOU-[A-Z0-9]{6}$/.test(paramId)) {
                    localStorage.setItem('cashvault_architect_id', paramId);
                    localStorage.setItem('command_center_architect_id', paramId);
                    try { var cleanUrl = window.location.pathname + window.location.hash; window.history.replaceState({}, document.title, cleanUrl); } catch(e) {}
                    runVerificationCeremony(paramId);
                    return 'ceremony';
                }
            }

            var storedId = localStorage.getItem('cashvault_architect_id') || localStorage.getItem('command_center_architect_id');
            if (storedId) {
                runVerificationCeremony(storedId);
                return 'ceremony';
            }

            if (isBridgeUser()) {
                var tempId = localStorage.getItem('command_center_temp_id');
                if (!tempId) { tempId = generateTempArchitectId(); localStorage.setItem('command_center_temp_id', tempId); }
                localStorage.setItem('command_center_architect_id', tempId);
                runVerificationCeremony(tempId);
                return 'ceremony';
            }

            if (hasEcosystemActivity()) {
                var ecoTempId = localStorage.getItem('command_center_temp_id');
                if (!ecoTempId) { ecoTempId = generateTempArchitectId(); localStorage.setItem('command_center_temp_id', ecoTempId); }
                localStorage.setItem('command_center_architect_id', ecoTempId);
                runEcosystemTheater(ecoTempId);
                return 'theater';
            }

            document.getElementById('mainDashboard').style.display = 'none';
            document.getElementById('gateContent').style.display = 'block';
            document.getElementById('gatePreview').style.display = 'block';
            document.getElementById('gateVerifyState').classList.remove('show');
            document.getElementById('accessGate').classList.add('show');
            updateArchitectCount();
            return 'gate';
        }

        function gateManualEntry() {
            var input = document.getElementById('gateIdInput');
            var error = document.getElementById('gateError');
            var id = input.value.trim().toUpperCase();
            if (/^KOU-[A-Z0-9]{6}$/.test(id)) {
                localStorage.setItem('cashvault_architect_id', id);
                localStorage.setItem('command_center_architect_id', id);
                error.style.display = 'none';
                runVerificationCeremony(id);
            } else {
                error.style.display = 'block';
                input.style.borderColor = 'var(--danger)';
                setTimeout(function() { input.style.borderColor = ''; }, 2000);
            }
        }

        document.getElementById('gateIdInput').addEventListener('input', function(e) {
            var value = e.target.value.toUpperCase().replace(/[^A-Z0-9-]/g, '');
            if (value.length > 0 && !value.startsWith('KOU-') && !value.startsWith('KOU') && !value.startsWith('KO') && !value.startsWith('K')) {
                if (value.length <= 6) value = 'KOU-' + value;
            }
            if (value.length > 4 && value[3] !== '-') value = value.slice(0, 3) + '-' + value.slice(3);
            e.target.value = value.slice(0, 10);
        });

        document.getElementById('gateIdInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') gateManualEntry();
        });

        document.addEventListener('DOMContentLoaded', function() { checkAccess(); });

        function initDashboard() {
            loadArchitectId();
            loadCompletionStatus();
            loadUnlockStatus();
            renderDashboard();
            trackStartDate();
            updateWelcomeBanner();
            writeEcosystemContext();
        }

        function loadArchitectId() {
            currentArchitectId = localStorage.getItem('cashvault_architect_id') ||
                                localStorage.getItem('command_center_architect_id') ||
                                localStorage.getItem('command_center_temp_id') ||
                                'KOU-??????';
        }

        function trackStartDate() {
            if (!localStorage.getItem('architect_start_date')) {
                localStorage.setItem('architect_start_date', new Date().toISOString());
            }
        }

        function loadCompletionStatus() {
            completedSystems = [];
            SYSTEMS.forEach(function(system) {
                if (checkSystemCompletion(system.id)) {
                    completedSystems.push(system.id);
                    if (localStorage.getItem(system.storageKey) !== 'true') {
                        localStorage.setItem(system.storageKey, 'true');
                    }
                }
            });
            if (localStorage.getItem('cashvault_architect_id') && completedSystems.indexOf('autopilot') === -1) {
                completedSystems.push('autopilot');
                localStorage.setItem('autopilot_completed', 'true');
            }
        }

        function loadUnlockStatus() {
            unlockedSystems = ['autopilot'];
            SYSTEMS.forEach(function(system) {
                if (completedSystems.indexOf(system.id) !== -1) {
                    if (unlockedSystems.indexOf(system.id) === -1) unlockedSystems.push(system.id);
                    return;
                }
                if (system.unlockType === 'completion' && system.unlockRequires) {
                    if (completedSystems.indexOf(system.unlockRequires) !== -1) {
                        if (unlockedSystems.indexOf(system.id) === -1) unlockedSystems.push(system.id);
                    }
                }
                if (system.unlockType === 'level') {
                    var level = getArchitectLevel();
                    if (system.unlockLevel === 'silver' && ['silver', 'gold', 'elite'].indexOf(level) !== -1) {
                        if (unlockedSystems.indexOf(system.id) === -1) unlockedSystems.push(system.id);
                    }
                }
                if (system.unlockType === 'code' && localStorage.getItem(system.unlockKey) === 'true') {
                    if (unlockedSystems.indexOf(system.id) === -1) unlockedSystems.push(system.id);
                }
                if (system.unlockType === 'dual') {
                    var lvl = getArchitectLevel();
                    var hasCode = localStorage.getItem(system.unlockKey) === 'true';
                    if ((system.unlockLevel === 'gold' && ['gold', 'elite'].indexOf(lvl) !== -1) || hasCode) {
                        if (unlockedSystems.indexOf(system.id) === -1) unlockedSystems.push(system.id);
                    }
                }
            });
        }

        function getArchitectLevel() {
            var count = completedSystems.length;
            if (count >= 7) return 'elite';
            if (count >= 5) return 'gold';
            if (count >= 3) return 'silver';
            return 'bronze';
        }

        function getVelocityScore() {
            var count = completedSystems.length;
            if (count >= 7) return { score: '2.0x', desc: 'Maximum velocity. All tools operational. You are the machine.', label: 'elite' };
            if (count >= 5) return { score: '1.5x', desc: 'High velocity. Two more tools to max. Do not lose momentum.', label: 'high' };
            if (count >= 3) return { score: '1.25x', desc: "You're accelerating. The compound effect is kicking in.", label: 'mid' };
            if (count >= 2) return { score: '1.1x', desc: 'Second system online. Velocity climbing. Keep stacking.', label: 'rising' };
            if (count >= 1) return { score: '1.0x', desc: 'Engine started. Each tool you complete compounds the last.', label: 'low' };
            return { score: '1.0x', desc: 'Complete your first tool to start building velocity.', label: 'zero' };
        }

        function updateWelcomeBanner() {
            var banner = document.getElementById('welcomeBanner');
            var titleEl = document.getElementById('welcomeBannerTitle');
            var descEl = document.getElementById('welcomeBannerDesc');
            var btnEl = document.getElementById('welcomeBannerBtn');
            var btnTextEl = document.getElementById('welcomeBannerBtnText');

            if (!isBridgeUser() && !isTempId(currentArchitectId)) { banner.classList.remove('show'); return; }

            if (!localStorage.getItem('bridge_entry_tool_count')) {
                localStorage.setItem('bridge_entry_tool_count', String(completedSystems.length));
            }
            var entryCount = parseInt(localStorage.getItem('bridge_entry_tool_count') || '0', 10);
            if (completedSystems.length > entryCount && completedSystems.length >= 2) { banner.classList.remove('show'); return; }

            var nextSystem = SYSTEMS
                .filter(function(s) { return completedSystems.indexOf(s.id) === -1 && unlockedSystems.indexOf(s.id) !== -1; })
                .sort(function(a, b) { return a.priority - b.priority; })[0];
            if (!nextSystem) { banner.classList.remove('show'); return; }

            var count = completedSystems.length;
            titleEl.textContent = count + '/7 tools active';

            if (count === 0) {
                descEl.innerHTML = 'You are inside the machine. Zero tools running. <strong>' + nextSystem.name + '</strong> is your ignition switch.';
            } else if (count === 1) {
                descEl.innerHTML = 'First system online. <strong>' + nextSystem.name + '</strong> is the next piece. Each one compounds the last.';
            } else {
                descEl.innerHTML = count + ' systems running. <strong>' + nextSystem.name + '</strong> is next. Do not stop building.';
            }

            btnTextEl.textContent = 'Open ' + nextSystem.name.split(' ')[0];
            btnEl.href = nextSystem.url;
            btnEl.onclick = null;
            banner.classList.add('show');
        }

        function renderDashboard() {
            document.getElementById('displayArchitectId').textContent = currentArchitectId;

            var startDate = localStorage.getItem('architect_start_date');
            if (startDate) {
                var days = Math.max(1, Math.ceil((new Date() - new Date(startDate)) / (1000 * 60 * 60 * 24)));
                document.getElementById('daysBuilding').textContent = days;
            }

            var freedomData = localStorage.getItem('freedom_calculator_result');
            if (freedomData) {
                try {
                    var data = JSON.parse(freedomData);
                    if (data.freedomYears) {
                        var freedomYear = new Date().getFullYear() + parseInt(data.freedomYears);
                        document.getElementById('freedomDate').textContent = freedomYear;
                        document.getElementById('freedomSub').textContent = data.freedomYears + ' years';
                        document.getElementById('freedomCta').style.display = 'none';
                    }
                } catch(e) {}
            }

            var velocity = getVelocityScore();
            document.getElementById('velocityScore').textContent = velocity.score;
            document.getElementById('velocityDesc').textContent = velocity.desc;
            try {
                localStorage.setItem('cashvault_velocity', JSON.stringify({ score: velocity.score, label: velocity.label, systems: completedSystems.length }));
            } catch(e) {}

            document.getElementById('systemsCompleted').textContent = completedSystems.length + '/7';
            document.getElementById('systemsCount').textContent = completedSystems.length + '/7';

            renderSystemsGrid();
            updateArchitectLevel();
            updateNextAction();
            updateWelcomeBanner();
            writeEcosystemContext();
        }

        function goToFreedomCalc() {
            if (unlockedSystems.indexOf('freedom') !== -1) { window.location.href = CONFIG.FREEDOM_CALCULATOR_URL; }
            else { var freedomSystem = SYSTEMS.find(function(s) { return s.id === 'freedom'; }); showInfoModal(freedomSystem); }
        }

        function renderSystemsGrid() {
            var grid = document.getElementById('systemsGrid');
            grid.innerHTML = '';
            SYSTEMS.forEach(function(system) {
                var isCompleted = completedSystems.indexOf(system.id) !== -1;
                var isUnlocked = unlockedSystems.indexOf(system.id) !== -1;
                var isSocialAction = system.socialAction && !isUnlocked && !isCompleted;

                var card = document.createElement('div');
                var classNames = ['system-card'];
                if (isCompleted) classNames.push('completed');
                if (!isUnlocked) classNames.push('locked');
                if (isSocialAction) {
                    classNames.push('social-action');
                    if (system.socialAction === 'dm') classNames.push('dm-unlock');
                    if (system.socialAction === 'story') classNames.push('story-unlock');
                }
                card.className = classNames.join(' ');

                var actionBadgeHtml = '';
                if (isSocialAction) {
                    if (system.socialAction === 'dm') actionBadgeHtml = '<span class="action-badge dm">\uD83D\uDDD1\uFE0F DM to Unlock</span>';
                    else if (system.socialAction === 'story') actionBadgeHtml = '<span class="action-badge story">\uD83D\uDCF8 Story to Unlock</span>';
                }

                var descText = system.desc;
                var descClass = 'system-desc';
                if (isCompleted) {
                    var context = getCompletionContext(system.id);
                    if (context) { descText = context; descClass = 'system-desc completed-context'; }
                }

                card.innerHTML =
                    actionBadgeHtml +
                    '<div class="system-icon">' + system.icon + '</div>' +
                    '<div class="system-info">' +
                        '<div class="system-name">' + system.name + '</div>' +
                        '<div class="' + descClass + '">' + descText + '</div>' +
                    '</div>' +
                    '<div class="system-status">' + (isCompleted ? '\u2705' : (isUnlocked ? '\u25CB' : '\uD83D\uDD12')) + '</div>';

                if (isUnlocked) { card.onclick = function() { window.location.href = system.url; }; }
                else { card.onclick = (function(s) { return function() { showInfoModal(s); }; })(system); }
                grid.appendChild(card);
            });
        }

        function showInfoModal(system) {
            currentModalSystem = system;
            var modal = document.getElementById('infoModal');
            var card = document.getElementById('infoModalCard');
            var icon = document.getElementById('infoModalIcon');
            var title = document.getElementById('infoModalTitle');
            var subtitle = document.getElementById('infoModalSubtitle');
            var content = document.getElementById('infoModalContent');
            var primaryBtn = document.getElementById('infoModalPrimaryBtn');
            var exp = system.unlockExplanation;

            card.className = 'info-modal-card';
            if (system.unlockType === 'code' || system.socialAction === 'dm') card.classList.add('pink');
            if (system.unlockType === 'dual' || system.socialAction === 'story') card.classList.add('gold');

            icon.textContent = system.icon;
            title.textContent = 'Unlock ' + system.name;
            subtitle.textContent = exp.subtitle;

            var contentHtml = '';
            if (exp.dualOptions) {
                contentHtml += '<div class="dual-options">';
                exp.dualOptions.forEach(function(opt, i) {
                    contentHtml += '<div class="dual-option' + (i === 0 ? ' selected' : '') + '" onclick="selectDualOption(' + i + ')"><div class="dual-option-icon">' + opt.icon + '</div><div class="dual-option-title">' + opt.title + '</div><div class="dual-option-desc">' + opt.desc + '</div></div>';
                });
                contentHtml += '</div>';
                exp.dualOptions.forEach(function(opt, i) {
                    var stepColor = i === 0 ? 'gold' : 'pink';
                    contentHtml += '<div class="dual-section' + (i === 0 ? ' show' : '') + '" id="dualSection' + i + '"><div class="unlock-method"><div class="unlock-method-title ' + stepColor + '">' + opt.title + '</div>';
                    opt.steps.forEach(function(step, j) { contentHtml += '<div class="unlock-step"><span class="unlock-step-num ' + stepColor + '">' + (j + 1) + '</span><span class="unlock-step-text">' + step + '</span></div>'; });
                    contentHtml += '</div>';
                    if (i === 0) contentHtml += '<p style="text-align:center;color:var(--accent-gold);font-weight:700;margin-bottom:15px;">Your progress: ' + completedSystems.length + '/5 tools</p>';
                    if (i === 1) contentHtml += '<p style="text-align:center;margin-top:15px;"><button class="info-modal-btn primary gold" style="width:100%;" onclick="showVaultCodeModal()">I Have My Code &rarr;</button></p>';
                    contentHtml += '</div>';
                });
                primaryBtn.style.display = 'none';
            } else if (exp.secretKeyword) {
                contentHtml += '<div class="secret-keyword-box"><div class="secret-keyword-label">\uD83E\uDD2B Secret Keyword</div><div class="secret-keyword">' + exp.secretKeyword + '</div></div>';
                contentHtml += '<div class="unlock-method"><div class="unlock-method-title pink">How to Unlock</div>';
                exp.steps.forEach(function(step, i) { contentHtml += '<div class="unlock-step"><span class="unlock-step-num pink">' + (i + 1) + '</span><span class="unlock-step-text">' + step + '</span></div>'; });
                contentHtml += '</div>';
                primaryBtn.textContent = '\uD83D\uDD11 I Have My Code';
                primaryBtn.className = 'info-modal-btn primary pink';
                primaryBtn.style.display = 'flex';
            } else {
                var stepColor = system.unlockType === 'level' ? 'gold' : '';
                contentHtml += '<div class="unlock-method"><div class="unlock-method-title ' + stepColor + '">' + exp.title + '</div>';
                exp.steps.forEach(function(step, i) { contentHtml += '<div class="unlock-step"><span class="unlock-step-num ' + stepColor + '">' + (i + 1) + '</span><span class="unlock-step-text">' + step + '</span></div>'; });
                contentHtml += '</div>';
                if (exp.showProgress) {
                    var needed = system.unlockLevel === 'silver' ? 3 : 5;
                    contentHtml += '<p style="text-align:center;color:var(--accent-gold);font-weight:700;">Your progress: ' + completedSystems.length + '/' + needed + ' tools</p>';
                }
                if (system.unlockType === 'completion' && system.unlockRequires) {
                    var reqSystem = SYSTEMS.find(function(s) { return s.id === system.unlockRequires; });
                    primaryBtn.textContent = 'Open ' + reqSystem.name + ' \u2192';
                    primaryBtn.className = 'info-modal-btn primary';
                    primaryBtn.style.display = 'flex';
                } else if (system.unlockType === 'level') {
                    primaryBtn.textContent = 'Keep Building \u2192';
                    primaryBtn.className = 'info-modal-btn primary gold';
                    primaryBtn.style.display = 'flex';
                } else { primaryBtn.style.display = 'none'; }
            }
            content.innerHTML = contentHtml;
            modal.classList.add('show');
        }

        function closeInfoModal() { document.getElementById('infoModal').classList.remove('show'); currentModalSystem = null; }

        function handleInfoModalAction() {
            if (!currentModalSystem) return;
            if (currentModalSystem.unlockType === 'code') { closeInfoModal(); showBudgetCodeModal(); }
            else if (currentModalSystem.unlockType === 'completion' && currentModalSystem.unlockRequires) {
                var reqSystem = SYSTEMS.find(function(s) { return s.id === currentModalSystem.unlockRequires; });
                window.location.href = reqSystem.url;
            } else { closeInfoModal(); }
        }

        function selectDualOption(index) {
            document.querySelectorAll('.dual-option').forEach(function(el, i) { el.classList.toggle('selected', i === index); });
            document.querySelectorAll('.dual-section').forEach(function(el, i) { el.classList.toggle('show', i === index); });
        }

        function showBudgetCodeModal() { document.getElementById('budgetCodeInput').value = ''; document.getElementById('budgetCodeError').style.display = 'none'; document.getElementById('budgetCodeModal').classList.add('show'); }
        function closeBudgetCodeModal() { document.getElementById('budgetCodeModal').classList.remove('show'); }

        function verifyBudgetCode() {
            var input = document.getElementById('budgetCodeInput');
            var error = document.getElementById('budgetCodeError');
            var code = input.value.trim().toUpperCase();
            if (simpleHash(code) === BUDGET_HASH) {
                localStorage.setItem('budget_unlocked', 'true');
                closeBudgetCodeModal();
                loadUnlockStatus();
                renderDashboard();
                showSuccessModal('Budget Calculator Unlocked!', 'Cash flow control activated.');
            } else { error.style.display = 'block'; input.style.borderColor = 'var(--danger)'; }
        }

        function showVaultCodeModal() { closeInfoModal(); document.getElementById('vaultCodeInput').value = ''; document.getElementById('vaultCodeError').style.display = 'none'; document.getElementById('vaultCodeModal').classList.add('show'); }
        function closeVaultCodeModal() { document.getElementById('vaultCodeModal').classList.remove('show'); }

        function verifyVaultCode() {
            var input = document.getElementById('vaultCodeInput');
            var error = document.getElementById('vaultCodeError');
            var code = input.value.trim().toUpperCase();
            if (simpleHash(code) === VAULT_HASH) {
                localStorage.setItem('vault_unlocked', 'true');
                closeVaultCodeModal();
                loadUnlockStatus();
                renderDashboard();
                showSuccessModal('Prompt Vault Unlocked!', 'AI arsenal activated.');
            } else { error.style.display = 'block'; input.style.borderColor = 'var(--danger)'; }
        }

        function showSuccessModal(titleText, descText) {
            var modal = document.getElementById('infoModal');
            var card = document.getElementById('infoModalCard');
            card.className = 'info-modal-card';
            document.getElementById('infoModalIcon').textContent = '\uD83C\uDF89';
            document.getElementById('infoModalTitle').textContent = titleText;
            document.getElementById('infoModalSubtitle').textContent = descText;
            document.getElementById('infoModalContent').innerHTML = '';
            document.getElementById('infoModalPrimaryBtn').style.display = 'none';
            modal.classList.add('show');
            triggerCelebration(); /* FIX 1: Celebration on unlock success too */
            setTimeout(function() { modal.classList.remove('show'); }, 2000);
        }

        function updateArchitectLevel() {
            var count = completedSystems.length;
            var badge = document.getElementById('levelBadge');
            var name = document.getElementById('levelName');
            var bar = document.getElementById('levelProgressBar');
            var current = document.getElementById('levelCurrentXp');
            var next = document.getElementById('levelNextReward');
            var level, progress, nextReward;

            if (count >= 7) { level = 'elite'; progress = 100; nextReward = 'Max level \uD83D\uDC51'; document.getElementById('nextAction').style.display = 'none'; document.getElementById('allComplete').style.display = 'block'; }
            else if (count >= 5) { level = 'gold'; progress = 70 + ((count - 5) / 2) * 30; nextReward = (7 - count) + ' more \u2192 Elite'; }
            else if (count >= 3) { level = 'silver'; progress = 40 + ((count - 3) / 2) * 30; nextReward = (5 - count) + ' more \u2192 Gold'; }
            else { level = 'bronze'; progress = count === 0 ? 0 : 5 + (count / 3) * 35; nextReward = (3 - count) + ' more \u2192 Silver'; }

            badge.className = 'level-badge ' + level;
            name.textContent = level.charAt(0).toUpperCase() + level.slice(1);
            bar.className = 'level-progress-bar ' + level;
            bar.style.width = progress + '%';
            current.textContent = count + ' / 7 tools';
            next.textContent = nextReward;
        }

        function updateNextAction() {
            var title = document.getElementById('nextActionTitle');
            var desc = document.getElementById('nextActionDesc');
            var btn = document.getElementById('nextActionBtn');
            var btnText = document.getElementById('nextActionBtnText');
            var actionSection = document.getElementById('nextAction');

            var nextSystem = SYSTEMS
                .filter(function(s) { return completedSystems.indexOf(s.id) === -1 && unlockedSystems.indexOf(s.id) !== -1; })
                .sort(function(a, b) { return a.priority - b.priority; })[0];

            if (nextSystem) {
                actionSection.className = 'next-action';
                var messages = {
                    autopilot: { title: 'Install Autopilot System', desc: 'Your core wealth machine. Everything builds on this.' },
                    freedom: { title: 'Calculate Freedom Number', desc: "Can't hit a target you can't see." },
                    waiting: { title: 'See What Waiting Costs', desc: 'Every day you delay costs you money.' },
                    investment: { title: 'Build Your Portfolio', desc: 'Turn deposits into a growing wealth engine.' },
                    '800club': { title: 'Hit 800 Credit Score', desc: 'Credit is leverage. Follow the protocol.' },
                    budget: { title: 'Map Cash Flow', desc: 'Know where every dollar goes.' },
                    prompt: { title: 'Unlock AI Vault', desc: 'Pre-built prompts for acceleration.' }
                };
                var msg = messages[nextSystem.id];
                title.textContent = msg.title;
                desc.textContent = msg.desc;
                btn.href = nextSystem.url;
                btn.onclick = null;
                btnText.textContent = 'Open ' + nextSystem.name.split(' ')[0];
            } else {
                var nextLocked = SYSTEMS.find(function(s) { return completedSystems.indexOf(s.id) === -1 && unlockedSystems.indexOf(s.id) === -1; });
                if (nextLocked) {
                    actionSection.className = 'next-action level-up';
                    title.textContent = 'Level Up to Unlock ' + nextLocked.name;
                    var reqText = '';
                    if (nextLocked.unlockType === 'level') reqText = 'Reach ' + nextLocked.unlockLevel.charAt(0).toUpperCase() + nextLocked.unlockLevel.slice(1) + ' level';
                    else if (nextLocked.unlockType === 'code') reqText = 'DM @koutalksmoney to get the unlock code';
                    else if (nextLocked.unlockType === 'dual') reqText = 'Reach Gold level or post your certificate on your story';
                    desc.textContent = reqText + '. Your progress: ' + completedSystems.length + '/7 tools.';
                    btn.href = '#';
                    btn.onclick = function(e) { e.preventDefault(); showInfoModal(nextLocked); };
                    btnText.textContent = 'See How to Unlock';
                }
            }
        }

        function shareToInstagram() {
            var modal = document.getElementById('shareModal');
            document.getElementById('shareCardId').textContent = currentArchitectId;
            document.getElementById('shareCardStats').textContent = completedSystems.length + '/7 Tools Active';
            document.getElementById('shareCardLevel').textContent = getArchitectLevel().charAt(0).toUpperCase() + getArchitectLevel().slice(1) + ' Architect';
            modal.classList.add('show');
        }
        function closeShareModal() { document.getElementById('shareModal').classList.remove('show'); }

        function shareToTwitter() {
            var text = encodeURIComponent(completedSystems.length + '/7 wealth tools active \u26A1\n\nArchitect ID: ' + currentArchitectId + '\n\n@koutalksmoney');
            window.open('https://twitter.com/intent/tweet?text=' + text, '_blank');
        }

        function copyShareText() {
            var text = completedSystems.length + '/7 wealth tools active \u26A1\n\nArchitect ID: ' + currentArchitectId + '\n\nBuilding the machine.\n\n@koutalksmoney';
            navigator.clipboard.writeText(text);
            showSuccessModal('Copied!', 'Caption ready to paste.');
        }

        function copyArchitectId() {
            navigator.clipboard.writeText(currentArchitectId);
            var badge = document.querySelector('.architect-badge');
            var original = badge.innerHTML;
            badge.innerHTML = '<span>\u2713 Copied!</span>';
            setTimeout(function() { badge.innerHTML = original; }, 1500);
        }

        function writeEcosystemContext() {
            try {
                var context = {
                    architectId: currentArchitectId,
                    isTempId: isTempId(currentArchitectId),
                    isBridgeUser: isBridgeUser(),
                    level: getArchitectLevel(),
                    velocity: getVelocityScore().score,
                    completedCount: completedSystems.length,
                    completedSystems: completedSystems,
                    lastVisit: new Date().toISOString()
                };
                localStorage.setItem('cashvault_ecosystem', JSON.stringify(context));
            } catch(e) {}
        }
    </script>
</body>
</html>
