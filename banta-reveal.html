<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banta Elementary BGC - Student of the Month</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --background-dark: #1a1a2e; --background-light: #16213e; --primary-glow: #00a8ff;
            --text-light: #e0e0e0; --neon-pink: #e03bff; --neon-blue: #00c2ff;
            --neon-green: #2eff7e; --neon-yellow: #f8f32b; --neon-orange: #ff7b1d;
        }
        body { margin: 0; font-family: 'Poppins', sans-serif; background: linear-gradient(180deg, var(--background-dark), var(--background-light)); color: var(--text-light); overflow: hidden; height: 100vh; display: flex; justify-content: center; align-items: center; }
        #app-container { width: 100%; height: 100%; position: relative; }
        .screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; opacity: 0; visibility: hidden; transition: opacity 0.6s ease, visibility 0.6s; padding: 1rem; box-sizing: border-box; }
        .screen.active { opacity: 1; visibility: visible; }
        .main-title { font-size: 2.8rem; font-weight: 700; color: white; text-shadow: 0 0 15px var(--primary-glow); margin-bottom: 0.5rem; line-height: 1.2; }
        .subtitle { font-size: 1.5rem; font-weight: 400; color: var(--text-light); margin-top: 0; }
        .cta-button { background-color: transparent; color: white; border: 2px solid var(--primary-glow); padding: 1rem 2rem; border-radius: 50px; font-size: 1.2rem; font-weight: 600; cursor: pointer; transition: background-color 0.3s ease, box-shadow 0.3s ease, transform 0.2s ease; margin-top: 1.5rem; }
        .cta-button:hover { background-color: var(--primary-glow); box-shadow: 0 0 20px var(--primary-glow); transform: translateY(-3px); }
        
        #initiation-sequence-screen .sequence-text { font-size: 2rem; color: var(--primary-glow); opacity: 0; animation: fadeIn 1s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        #balloon-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(120px, 1fr)); gap: 1.5rem; width: 90%; max-width: 800px; }
        .balloon { aspect-ratio: 1 / 1.2; border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%; cursor: pointer; position: relative; transform-style: preserve-3d; animation: bobbing 7s ease-in-out infinite alternate; background: radial-gradient(circle at 35% 35%, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0.2) 15%, transparent 40%); }
        .balloon-color { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border-radius: inherit; z-index: -1; }
        .balloon::after { content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 12px; height: 12px; background: inherit; clip-path: polygon(50% 100%, 0 0, 100% 0); }
        .balloon:hover { transform: scale(1.05); }
        .popped { animation: pop 0.5s cubic-bezier(0.2, 0.9, 0.7, 1) forwards; }
        @keyframes pop { 0% { transform: scale(1); opacity: 1; } 50% { transform: scale(1.15); opacity: 0.8; } 100% { transform: scale(0); opacity: 0; } }
        @keyframes bobbing { from { transform: translateY(0) rotate(-2deg); } to { transform: translateY(-20px) rotate(2deg); } }
        
        #cheer-meter-container { position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); width: 80%; max-width: 400px; background-color: rgba(0, 0, 0, 0.3); border-radius: 50px; padding: 5px; border: 1px solid rgba(255, 255, 255, 0.1); z-index: 10; }
        #cheer-meter-bar { height: 25px; background: linear-gradient(90deg, var(--neon-pink), var(--neon-blue)); border-radius: 50px; transition: width 0.3s ease; }
        #cheer-meter-label { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-weight: 600; text-shadow: 0 0 5px black; width: 100%; text-align: center; font-size: 0.9rem; }
        #pop-percentage { margin-left: 8px; font-variant-numeric: tabular-nums; }
        
        #reveal-moment { background-color: rgba(10, 10, 20, 0.9); backdrop-filter: blur(15px); z-index: 100; }
        #reveal-prompt { font-size: 2.5rem; color: var(--primary-glow); text-shadow: 0 0 10px var(--primary-glow); display: none; }
        
        #winner-card { display: none; flex-direction: column; align-items: center; background: linear-gradient(135deg, #2a2a4e, #1a1a2e); padding: 2rem; border-radius: 20px; border: 1px solid var(--primary-glow); box-shadow: 0 0 40px rgba(0, 168, 255, 0.3); transform: scale(0.5); color: white; transition: transform 0.5s cubic-bezier(0.18, 0.89, 0.32, 1.28); }
        #reveal-moment.active #winner-card.visible { transform: scale(1); }
        #winner-avatar { width: 120px; height: 120px; border-radius: 50%; border: 5px solid var(--primary-glow); margin-bottom: 1rem; object-fit: cover; background-color: #333; }
        .winner-title { font-size: 1.2rem; color: var(--primary-glow); margin: 0; }
        .winner-name { font-size: 2.2rem; font-weight: 700; margin: 0.5rem 0; }
        .winner-blurb { font-size: 1rem; max-width: 400px; color: var(--text-light); }
        .reveal-actions { margin-top: 1.5rem; }
        .secondary-link { color: var(--primary-glow); text-decoration: none; font-weight: 600; cursor: pointer; }
        
        #confetti-container { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; pointer-events: none; z-index: 200; }
        .confetti-final { position: absolute; width: 10px; height: 15px; opacity: 0; animation: fall 5s linear forwards; }
        @keyframes fall { 0% { transform: translateY(-10vh) rotateZ(0deg); opacity: 1; } 100% { transform: translateY(110vh) rotateZ(720deg); opacity: 0; } }
        .confetti-burst { position: absolute; width: 8px; height: 8px; border-radius: 50%; pointer-events: none; animation: burst 1s ease-out forwards; }
        @keyframes burst { 0% { transform: translate(0, 0) scale(1); opacity: 1; } 100% { transform: translate(var(--tx), var(--ty)) scale(0); opacity: 0; } }

        @media (max-width: 600px) {
            .main-title { font-size: 2rem; }
            .subtitle { font-size: 1.2rem; }
            #balloon-grid { grid-template-columns: repeat(2, 1fr); gap: 1rem; }
            #reveal-prompt { font-size: 1.8rem; }
            #winner-card { padding: 1.5rem; width: 90%; }
            .winner-name { font-size: 1.8rem; }
            .winner-blurb { font-size: 0.9rem; }
        }
    </style>
</head>
<body>
    <div id="app-container">
        <section id="welcome-screen" class="screen active">
            <div>
                <header><h1 class="main-title">Banta Elementary<br>Boys & Girls Club</h1><h2 class="subtitle">Student of the Month Reveal</h2></header>
                <main><button id="initiate-btn" class="cta-button">Reveal!</button></main>
            </div>
        </section>
        <section id="initiation-sequence-screen" class="screen">
            <div><h2 class="sequence-text">Pop all the balloons for the reveal!</h2></div>
        </section>
        <section id="balloon-stage" class="screen">
            <div id="balloon-grid"></div>
            <div id="cheer-meter-container">
                <div id="cheer-meter-bar" style="width: 0%;"></div>
                <span id="cheer-meter-label">Cheer Meter ðŸ“£ <span id="pop-percentage">0%</span></span>
            </div>
        </section>
        <div id="reveal-moment" class="screen">
            <h2 id="reveal-prompt">And the student of the month is...</h2>
            <div id="winner-card">
                <img src="" alt="Photo of the Student of the Month" id="winner-avatar">
                <h1 class="winner-title">Student of the Month</h1>
                <p class="winner-name" id="winner-name-display"></p>
                <p class="winner-blurb" id="winner-blurb-display"></p>
                <div class="reveal-actions"><a class="secondary-link" id="reset-btn">Play Again</a></div>
            </div>
            <div id="confetti-container"></div>
        </div>
    </div>

    <audio id="pop-sound" src="https://actions.google.com/sounds/v1/impacts/big_punchy_impact.ogg" preload="auto"></audio>
    <audio id="drumroll-sound" src="https://actions.google.com/sounds/v1/emergency/drum_roll.ogg" preload="auto"></audio>
    <audio id="reveal-sound" src="https://actions.google.com/sounds/v1/human_voices/human_crowd_cheer.ogg" preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const state = {
                winnerName: 'Jason',
                winnerBlurb: 'For great teamwork and a positive attitude.',
                winnerPhotoURL: 'jason-photo.jpg',
                balloonCount: 8,
                poppedCount: 0,
            };

            const screens = document.querySelectorAll('.screen');
            const initiateBtn = document.getElementById('initiate-btn');
            const resetBtn = document.getElementById('reset-btn');
            const balloonGrid = document.getElementById('balloon-grid');
            const cheerMeterBar = document.getElementById('cheer-meter-bar');
            const popPercentageSpan = document.getElementById('pop-percentage');
            const confettiContainer = document.getElementById('confetti-container');
            const popSound = document.getElementById('pop-sound');
            const drumrollSound = document.getElementById('drumroll-sound');
            const revealSound = document.getElementById('reveal-sound');
            const revealPrompt = document.getElementById('reveal-prompt');
            const winnerCard = document.getElementById('winner-card');

            function showScreen(screenId) {
                screens.forEach(screen => screen.classList.toggle('active', screen.id === screenId));
            }
            
            function startInitiationSequence() {
                showScreen('initiation-sequence-screen');
                setTimeout(setupAndShowBalloons, 2000); 
            }

            function setupAndShowBalloons() {
                balloonGrid.innerHTML = '';
                state.poppedCount = 0;
                const colors = ['--neon-pink', '--neon-blue', '--neon-green', '--neon-yellow', '--neon-orange'];
                
                for (let i = 0; i < state.balloonCount; i++) {
                    const balloon = document.createElement('div');
                    balloon.classList.add('balloon');
                    const balloonColor = document.createElement('div');
                    balloonColor.classList.add('balloon-color');
                    balloonColor.style.background = `var(${colors[i % colors.length]})`;
                    balloon.appendChild(balloonColor);
                    balloon.addEventListener('click', handleBalloonPop, { once: true });
                    balloonGrid.appendChild(balloon);
                }
                updateCheerMeter();
                showScreen('balloon-stage');
            }
            
            function handleBalloonPop(event) {
                const balloon = event.currentTarget;
                playSound(popSound);
                balloon.classList.add('popped');
                launchBurstConfetti(balloon);
                state.poppedCount++;
                updateCheerMeter();
                if (state.poppedCount === state.balloonCount) {
                    triggerRevealSequence();
                }
            }
            
            function triggerRevealSequence() {
                balloonGrid.style.pointerEvents = 'none';
                
                setTimeout(() => {
                    showScreen('reveal-moment');
                    revealPrompt.style.display = 'block';
                    winnerCard.style.display = 'none';
                    playSound(drumrollSound);
                    setTimeout(revealWinner, 3000);
                }, 800);
            }

            function revealWinner() {
                revealPrompt.style.display = 'none';
                
                document.getElementById('winner-name-display').textContent = state.winnerName;
                document.getElementById('winner-blurb-display').textContent = state.winnerBlurb;
                // (FIXED) Corrected the typo on this line
                document.getElementById('winner-avatar').src = state.winnerPhotoURL;
                
                winnerCard.style.display = 'flex';
                setTimeout(() => {
                    winnerCard.classList.add('visible');
                }, 50);

                playSound(revealSound);
                launchFinalConfetti();
            }

            function updateCheerMeter() {
                const percentage = Math.round((state.poppedCount / state.balloonCount) * 100);
                cheerMeterBar.style.width = `${percentage}%`;
                popPercentageSpan.textContent = `${percentage}%`;
            }

            function playSound(soundElement) {
                soundElement.currentTime = 0;
                soundElement.play().catch(error => console.error("Audio playback failed:", error));
            }
            
            function resetApp() {
                balloonGrid.style.pointerEvents = 'auto';
                winnerCard.classList.remove('visible');
                showScreen('welcome-screen');
            }

            function launchBurstConfetti(element) {
                const rect = element.getBoundingClientRect();
                const x = rect.left + rect.width / 2;
                const y = rect.top + rect.height / 2;
                const colors = ['var(--neon-pink)', 'var(--neon-blue)', 'var(--neon-green)', 'var(--neon-yellow)'];
                for (let i = 0; i < 20; i++) {
                    const particle = document.createElement('div');
                    particle.classList.add('confetti-burst');
                    particle.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    particle.style.left = `${x}px`; particle.style.top = `${y}px`;
                    const randomX = (Math.random() - 0.5) * 250; const randomY = (Math.random() - 0.5) * 250;
                    particle.style.setProperty('--tx', `${randomX}px`); particle.style.setProperty('--ty', `${randomY}px`);
                    // (FIXED) Append to the main confetti container for better control
                    confettiContainer.appendChild(particle); 
                    setTimeout(() => particle.remove(), 1000);
                }
            }

            function launchFinalConfetti() {
                confettiContainer.innerHTML = '';
                const colors = ['var(--neon-pink)', 'var(--neon-blue)', 'var(--neon-green)', 'var(--neon-yellow)'];
                for (let i = 0; i < 150; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti-final');
                    confetti.style.left = `${Math.random() * 100}vw`;
                    confetti.style.animationDelay = `${Math.random() * 2}s`;
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confettiContainer.appendChild(confetti);
                }
            }

            initiateBtn.addEventListener('click', startInitiationSequence);
            resetBtn.addEventListener('click', resetApp);
            
            showScreen('welcome-screen');
        });
    </script>
</body>
</html>
