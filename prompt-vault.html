<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Vault | Executive Access</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&family=JetBrains+Mono:wght@500&display=swap" rel="stylesheet"> 
    
    <style>
        :root {
            --bg-primary: #0a0e27;
            --bg-card: #1a1f3a;
            --accent-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            --accent-primary: #6366f1;
            --accent-secondary: #8b5cf6;
            --success: #10b981;
            --gold: #fbbf24;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --border: #2a3150;
        }
        * { box-sizing: border-box; }
        body {
            margin: 0; font-family: 'Inter', sans-serif;
            background-color: var(--bg-primary); color: var(--text-primary);
            overflow-x: hidden; min-height: 100vh;
        }
        body::before {
            content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(99, 102, 241, 0.15) 0%, transparent 50%),
                        radial-gradient(circle at 80% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
            z-index: -1; animation: floatGradient 20s ease infinite;
        }
        @keyframes floatGradient {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(-20px, -10px); }
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 20px; }
        @media (max-width: 768px) { .container { padding: 20px 16px; } }
        h1, h2, h3 { margin: 0; }
        .gradient-text {
            background: linear-gradient(135deg, #f1f5f9 0%, #cbd5e1 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .glass-card {
            background: linear-gradient(135deg, rgba(26, 31, 58, 0.9) 0%, rgba(21, 25, 51, 0.9) 100%);
            backdrop-filter: blur(10px); border: 1px solid var(--border);
            border-radius: 20px; padding: 24px; margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }
        @media (max-width: 768px) { .glass-card { padding: 20px 16px; border-radius: 16px; } }
        .input-group { margin-bottom: 0; }
        .input-group label {
            display: block; color: var(--text-secondary); font-size: 0.8rem;
            font-weight: 600; margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.05em;
        }
        .premium-input, .premium-textarea {
            width: 100%; background: rgba(10, 14, 39, 0.6); border: 1px solid var(--border);
            border-radius: 12px; padding: 14px; color: white; font-family: 'Inter', sans-serif;
            font-size: 0.95rem; transition: all 0.3s;
        }
        .premium-input:focus, .premium-textarea:focus {
            outline: none; border-color: var(--accent-primary);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.2);
        }
        .btn-primary {
            background: var(--accent-gradient); color: white; border: none; padding: 16px;
            border-radius: 12px; font-weight: 700; text-transform: uppercase;
            letter-spacing: 0.05em; cursor: pointer; transition: all 0.3s; width: 100%;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4); font-size: 0.9rem;
        }
        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px); box-shadow: 0 8px 25px rgba(99, 102, 241, 0.5);
        }
        .btn-primary:disabled { opacity: 0.7; cursor: not-allowed; }
        .nav-pill {
            background: transparent; border: 1px solid var(--border); color: var(--text-secondary);
            padding: 10px 20px; border-radius: 50px; cursor: pointer; transition: all 0.3s;
            font-size: 0.85rem; font-weight: 600; white-space: nowrap;
        }
        .nav-pill.active {
            background: var(--accent-gradient); color: white; border-color: transparent;
            box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
        }
        @media (max-width: 768px) { .nav-pill { padding: 8px 14px; font-size: 0.75rem; } }
        .sidebar-link {
            display: block; width: 100%; text-align: center; padding: 14px;
            border-radius: 12px; border: 1px solid var(--border); color: #cbd5e1;
            font-size: 0.9rem; font-weight: 600; transition: all 0.3s;
            text-decoration: none; background: rgba(255, 255, 255, 0.02);
        }
        .sidebar-link:hover {
            border-color: var(--accent-primary); color: white;
            background: rgba(99, 102, 241, 0.1);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.4); transform: translateY(-2px);
        }

        /* === GOAL-GRADIENT PROGRESS BAR === */
        .progress-container {
            background: rgba(10, 14, 39, 0.6); border-radius: 8px;
            padding: 12px 16px; margin-bottom: 20px; border: 1px solid var(--border);
        }
        .progress-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .progress-label { font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--text-secondary); font-weight: 600; }
        .progress-percent { font-size: 0.8rem; font-weight: 700; font-family: 'JetBrains Mono', monospace; transition: color 0.3s; }
        .progress-bar-track { height: 6px; background: rgba(99, 102, 241, 0.15); border-radius: 3px; overflow: hidden; }
        .progress-bar-fill {
            height: 100%; border-radius: 3px;
            transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1), background 0.3s; position: relative;
        }
        .progress-bar-fill::after {
            content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s infinite;
        }
        @keyframes shimmer { 0% { transform: translateX(-100%); } 100% { transform: translateX(100%); } }

        /* === OPERATIONAL TRANSPARENCY PANEL === */
        .transparency-panel { background: rgba(10, 14, 39, 0.8); border: 1px solid var(--border); border-radius: 12px; margin-top: 16px; overflow: hidden; }
        .transparency-header {
            display: flex; justify-content: space-between; align-items: center;
            padding: 12px 16px; cursor: pointer; background: rgba(99, 102, 241, 0.05);
            border-bottom: 1px solid var(--border);
        }
        .transparency-header:hover { background: rgba(99, 102, 241, 0.1); }
        .transparency-title { font-size: 0.75rem; text-transform: uppercase; letter-spacing: 0.1em; color: var(--accent-primary); font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .transparency-toggle { color: var(--text-secondary); font-size: 0.7rem; transition: transform 0.3s; }
        .transparency-toggle.open { transform: rotate(180deg); }
        .transparency-content { padding: 0; max-height: 0; overflow: hidden; transition: all 0.3s ease; }
        .transparency-content.open { padding: 16px; max-height: 300px; }
        .transparency-step { display: flex; align-items: center; gap: 12px; padding: 8px 0; opacity: 0.4; transition: all 0.3s; }
        .transparency-step.active { opacity: 1; }
        .transparency-step.complete { opacity: 0.7; }
        .step-indicator {
            width: 24px; height: 24px; border-radius: 50%; background: var(--border);
            display: flex; align-items: center; justify-content: center;
            font-size: 0.65rem; font-weight: 700; color: var(--text-secondary); flex-shrink: 0; transition: all 0.3s;
        }
        .transparency-step.active .step-indicator { background: var(--accent-gradient); color: white; box-shadow: 0 0 15px rgba(99, 102, 241, 0.5); }
        .transparency-step.complete .step-indicator { background: var(--success); color: white; }
        .step-text { font-size: 0.8rem; color: var(--text-secondary); }
        .transparency-step.active .step-text { color: var(--text-primary); }

        /* === BLUR GATE OVERLAY === */
        .blur-gate-container { position: relative; margin-top: 20px; }
        .blur-gate-preview { background: #0f1221; border: 1px solid var(--border); border-radius: 12px; padding: 20px; position: relative; overflow: hidden; }
        .blur-gate-visible { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: #e2e8f0; white-space: pre-wrap; line-height: 1.6; word-break: break-word; margin-bottom: 12px; }
        .blur-gate-blurred { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: #e2e8f0; white-space: pre-wrap; line-height: 1.6; word-break: break-word; filter: blur(8px); user-select: none; pointer-events: none; }
        .blur-gate-overlay {
            position: absolute; bottom: 0; left: 0; right: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(10, 14, 39, 0.9) 30%, rgba(10, 14, 39, 0.98) 100%);
            padding: 60px 20px 20px; display: flex; flex-direction: column; align-items: center; text-align: center;
        }
        .blur-gate-lock { font-size: 2rem; margin-bottom: 12px; }
        .blur-gate-title { color: var(--gold); font-size: 1rem; font-weight: 700; margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.05em; }
        .blur-gate-subtitle { color: var(--text-secondary); font-size: 0.8rem; margin-bottom: 16px; max-width: 280px; }
        .blur-gate-input {
            width: 100%; max-width: 300px; padding: 14px; background: var(--bg-primary);
            border: 2px solid var(--border); border-radius: 10px; color: var(--text-primary);
            font-size: 0.95rem; text-align: center; margin-bottom: 12px; transition: all 0.3s;
        }
        .blur-gate-input:focus { outline: none; border-color: var(--gold); box-shadow: 0 0 0 3px rgba(251, 191, 36, 0.2); }
        .blur-gate-input.error { border-color: #ef4444; }
        .blur-gate-error { color: #ef4444; font-size: 0.75rem; margin-bottom: 8px; }
        .blur-gate-btn {
            width: 100%; max-width: 300px; background: linear-gradient(135deg, var(--gold) 0%, #f59e0b 100%);
            color: #000; padding: 14px; border: none; border-radius: 10px; font-size: 0.9rem;
            font-weight: 700; cursor: pointer; text-transform: uppercase; transition: all 0.3s;
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .blur-gate-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(251, 191, 36, 0.4); }
        .blur-gate-btn:disabled { opacity: 0.7; cursor: not-allowed; }
        .blur-gate-trust { display: flex; justify-content: center; gap: 12px; margin-top: 12px; font-size: 0.65rem; color: var(--text-muted); }

        /* === UNLOCKED OUTPUT === */
        .output-box {
            background: #0f1221; border: 1px solid var(--success); border-radius: 12px;
            padding: 20px; margin-top: 20px; position: relative; animation: peakGlow 0.6s ease-out;
        }
        @keyframes peakGlow {
            0% { box-shadow: 0 0 0 rgba(16, 185, 129, 0); transform: scale(0.98); opacity: 0; }
            50% { box-shadow: 0 0 40px rgba(16, 185, 129, 0.4), 0 0 80px rgba(99, 102, 241, 0.2); }
            100% { box-shadow: 0 0 20px rgba(16, 185, 129, 0.15); transform: scale(1); opacity: 1; }
        }
        .output-box::before {
            content: ''; position: absolute; top: -1px; left: -1px; right: -1px; bottom: -1px;
            background: linear-gradient(135deg, var(--success), var(--accent-primary));
            border-radius: 13px; z-index: -1; opacity: 0; animation: borderPulse 2s ease-in-out infinite;
        }
        @keyframes borderPulse { 0%, 100% { opacity: 0.3; } 50% { opacity: 0.6; } }
        .output-code { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: #e2e8f0; white-space: pre-wrap; line-height: 1.6; word-break: break-word; }

        /* === LOADING STATE === */
        .loading-container { text-align: center; padding: 30px 20px; }
        .loading-spinner {
            width: 48px; height: 48px; border: 3px solid var(--border); border-top-color: var(--accent-primary);
            border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 16px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { font-size: 0.85rem; color: var(--accent-primary); font-weight: 600; margin-bottom: 4px; }
        .loading-subtext { font-size: 0.75rem; color: var(--text-secondary); }

        /* === THE VAULT (PRIMARY) === */
        .vault-container { margin-bottom: 25px; transition: all 0.3s ease; }
        .vault-card {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.08) 0%, rgba(245, 158, 11, 0.04) 100%);
            border: 2px solid rgba(251, 191, 36, 0.3); border-radius: 20px; overflow: hidden; transition: all 0.3s;
        }
        .vault-card.expanded { border-color: rgba(251, 191, 36, 0.5); box-shadow: 0 0 40px rgba(251, 191, 36, 0.15); }
        .vault-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; cursor: pointer; transition: background 0.3s; }
        .vault-header:hover { background: rgba(251, 191, 36, 0.05); }
        .vault-header-left { display: flex; align-items: center; gap: 14px; }
        .vault-icon { font-size: 1.8rem; }
        .vault-title { font-size: 1.1rem; font-weight: 800; color: var(--gold); margin: 0; }
        .vault-subtitle { font-size: 0.75rem; color: var(--text-secondary); margin: 0; }
        .vault-badge { display: flex; align-items: center; gap: 6px; padding: 6px 12px; background: rgba(251, 191, 36, 0.15); border: 1px solid rgba(251, 191, 36, 0.3); border-radius: 20px; font-size: 0.7rem; color: var(--gold); font-weight: 700; }
        .vault-toggle { color: var(--gold); font-size: 0.9rem; transition: transform 0.3s; }
        .vault-toggle.open { transform: rotate(180deg); }
        .vault-content { max-height: 0; overflow: hidden; transition: all 0.4s ease; }
        .vault-content.open { max-height: 600px; overflow-y: auto; }
        .vault-content-inner { padding: 0 24px 24px; }
        .vault-empty { text-align: center; padding: 40px 20px; color: var(--text-muted); }
        .vault-empty-icon { font-size: 2.5rem; margin-bottom: 12px; opacity: 0.5; }
        .vault-empty-text { font-size: 0.9rem; margin-bottom: 8px; }
        .vault-empty-hint { font-size: 0.75rem; }

        /* === VAULT PROMPT CARDS === */
        .vault-prompt-card { background: rgba(10, 14, 39, 0.6); border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin-bottom: 12px; transition: all 0.2s; }
        .vault-prompt-card:hover { border-color: rgba(251, 191, 36, 0.3); }
        .vault-prompt-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 10px; }
        .vault-prompt-meta { display: flex; align-items: center; gap: 8px; }
        .vault-prompt-category { font-size: 0.65rem; padding: 4px 10px; background: rgba(99, 102, 241, 0.2); border: 1px solid rgba(99, 102, 241, 0.3); border-radius: 12px; color: var(--accent-primary); font-weight: 600; }
        .vault-prompt-time { font-size: 0.65rem; color: var(--text-muted); }
        .vault-prompt-actions { display: flex; gap: 6px; }
        .vault-prompt-btn { padding: 5px 10px; font-size: 0.65rem; background: transparent; border: 1px solid var(--border); border-radius: 4px; color: var(--text-secondary); cursor: pointer; font-weight: 600; transition: all 0.2s; }
        .vault-prompt-btn:hover { border-color: var(--accent-primary); color: white; }
        .vault-prompt-btn.copied { background: var(--success); border-color: var(--success); color: white; }
        .vault-prompt-btn.delete:hover { border-color: #ef4444; color: #ef4444; }
        .vault-prompt-preview { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--text-secondary); white-space: pre-wrap; word-break: break-word; line-height: 1.5; cursor: pointer; transition: max-height 0.3s; }
        .vault-prompt-expand { font-size: 0.7rem; color: var(--accent-primary); font-weight: 600; margin-top: 8px; cursor: pointer; }

        /* === VAULT POINTER NOTIFICATION === */
        .vault-pointer {
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.15) 0%, rgba(16, 185, 129, 0.05) 100%);
            border: 2px solid var(--success); border-radius: 12px; padding: 16px 20px;
            margin-bottom: 20px; display: flex; align-items: center; gap: 12px;
            animation: pointerPulse 2s ease-in-out infinite, fadeSlideIn 0.5s ease;
        }
        @keyframes pointerPulse { 0%, 100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); } 50% { box-shadow: 0 0 20px 4px rgba(16, 185, 129, 0.2); } }
        @keyframes fadeSlideIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .vault-pointer-icon { font-size: 1.5rem; }
        .vault-pointer-text { flex: 1; }
        .vault-pointer-title { color: var(--success); font-size: 0.9rem; font-weight: 700; margin-bottom: 2px; }
        .vault-pointer-subtitle { color: var(--text-secondary); font-size: 0.75rem; }
        .vault-pointer-dismiss { background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 1.2rem; padding: 4px; line-height: 1; }
        .vault-pointer-dismiss:hover { color: white; }

        /* === ACHIEVEMENT/CERTIFICATE === */
        .achievement-banner {
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.15) 0%, rgba(251, 191, 36, 0.05) 100%);
            border: 2px solid rgba(251, 191, 36, 0.4); border-radius: 16px; padding: 25px;
            margin-bottom: 25px; text-align: center; animation: achievementReveal 0.6s ease; display: none;
        }
        .achievement-banner.show { display: block; }
        @keyframes achievementReveal { 0% { opacity: 0; transform: scale(0.9); } 50% { transform: scale(1.02); } 100% { opacity: 1; transform: scale(1); } }
        .achievement-icon { font-size: 2.5rem; margin-bottom: 15px; }
        .achievement-title { color: var(--gold); font-size: 1.2rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.1em; margin-bottom: 8px; }
        .achievement-subtitle { color: var(--text-secondary); font-size: 0.9rem; margin-bottom: 20px; }
        .achievement-card { background: linear-gradient(135deg, #0a0e27 0%, #151933 100%); border: 2px solid var(--gold); border-radius: 12px; padding: 20px; max-width: 350px; margin: 0 auto 20px; position: relative; }
        .achievement-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--gold), #f59e0b, var(--gold)); }
        .achievement-card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .achievement-card-logo { font-size: 0.75rem; font-weight: 700; color: var(--text-primary); }
        .achievement-card-badge { font-size: 0.6rem; padding: 4px 10px; background: rgba(251, 191, 36, 0.2); border-radius: 20px; color: var(--gold); font-weight: 700; text-transform: uppercase; }
        .achievement-card-title { font-size: 1.1rem; font-weight: 800; color: var(--gold); margin-bottom: 5px; }
        .achievement-card-name { font-size: 0.85rem; color: var(--text-primary); font-weight: 600; margin-bottom: 15px; }
        .achievement-card-stats { display: flex; justify-content: space-around; padding-top: 15px; border-top: 1px solid var(--border); }
        .achievement-stat { text-align: center; }
        .achievement-stat-value { font-size: 1.2rem; font-weight: 800; color: var(--success); }
        .achievement-stat-label { font-size: 0.6rem; color: var(--text-muted); text-transform: uppercase; }
        .achievement-share-btns { display: flex; gap: 10px; justify-content: center; }
        .achievement-share-btn { padding: 10px 20px; border-radius: 8px; font-size: 0.8rem; font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none; border: none; }
        .achievement-share-btn:hover { transform: translateY(-2px); }
        .achievement-share-btn.instagram { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); color: white; }
        .achievement-share-btn.copy { background: var(--bg-card); color: var(--text-primary); border: 1px solid var(--border); }
        .achievement-share-btn.copy.copied { background: var(--success); border-color: var(--success); }

        /* === GRID LAYOUTS === */
        .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; }
        @media (max-width: 640px) { .grid-2 { grid-template-columns: 1fr; gap: 12px; } }
        .main-grid { display: grid; grid-template-columns: 1fr 340px; gap: 24px; }
        @media (max-width: 1024px) { .main-grid { grid-template-columns: 1fr; } }
        .space-y-5 > * + * { margin-top: 16px; }
        .space-y-4 > * + * { margin-top: 12px; }
        .space-y-6 > * + * { margin-top: 20px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade-in { animation: fadeIn 0.5s ease forwards; }
        .nav-container { display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; }
        .module-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--border); flex-wrap: wrap; gap: 12px; }
        .module-title { font-size: 1.15rem; font-weight: 700; color: white; }
        .module-tabs { display: flex; gap: 12px; font-size: 0.75rem; }
        .module-tab { background: none; border: none; cursor: pointer; color: var(--text-secondary); font-weight: 600; padding: 0; transition: color 0.2s; }
        .module-tab.active { color: var(--accent-primary); }
        .module-tab-divider { color: var(--border); }
        .copy-btn { font-size: 0.75rem; padding: 6px 12px; border-radius: 6px; border: 1px solid var(--border); background: transparent; color: var(--text-secondary); cursor: pointer; transition: all 0.2s; font-weight: 600; }
        .copy-btn:hover { border-color: var(--accent-primary); color: white; }
        .copy-btn.copied { background: var(--success); border-color: var(--success); color: white; }

        /* === SAVE BUTTON — DOPAMINE FLASH (0.3s) === */
        .save-btn {
            font-size: 0.75rem; padding: 6px 12px; border-radius: 6px;
            border: 1px solid var(--gold); background: rgba(251, 191, 36, 0.1);
            color: var(--gold); cursor: pointer; font-weight: 600; margin-left: 8px;
            position: relative; overflow: hidden;
            transition: background 0.15s ease, border-color 0.15s ease, color 0.15s ease, transform 0.15s ease;
        }
        .save-btn:hover { background: var(--gold); color: #000; }
        .save-btn.saved-flash {
            background: var(--success); border-color: var(--success); color: white;
            animation: saveFlash 0.3s ease-out forwards;
        }
        @keyframes saveFlash {
            0%   { transform: scale(1);    box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
            50%  { transform: scale(1.1);  box-shadow: 0 0 18px 4px rgba(16, 185, 129, 0.45); }
            100% { transform: scale(1);    box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
        }

        /* === INLINE VAULT GUIDE (post-email education) === */
        .vault-guide-inline {
            display: flex; align-items: flex-start; gap: 12px;
            margin-top: 14px; padding: 14px 16px;
            background: linear-gradient(135deg, rgba(251, 191, 36, 0.08) 0%, rgba(251, 191, 36, 0.03) 100%);
            border: 1px solid rgba(251, 191, 36, 0.25); border-radius: 10px;
            animation: fadeSlideIn 0.4s ease;
        }
        .vault-guide-icon { font-size: 1.2rem; flex-shrink: 0; margin-top: 1px; }
        .vault-guide-content { flex: 1; }
        .vault-guide-title { font-size: 0.8rem; font-weight: 700; color: var(--gold); margin-bottom: 4px; }
        .vault-guide-text { font-size: 0.75rem; color: var(--text-secondary); line-height: 1.55; }
        .vault-guide-text strong { color: var(--text-primary); font-weight: 600; }

        .output-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; flex-wrap: wrap; gap: 8px; }
        .output-status { color: var(--success); font-size: 0.7rem; font-weight: 700; text-transform: uppercase; letter-spacing: 0.1em; display: flex; align-items: center; gap: 6px; }
        .output-status::before { content: ''; width: 6px; height: 6px; background: var(--success); border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .output-scroll { max-height: 280px; overflow-y: auto; }
        .output-scroll::-webkit-scrollbar { width: 6px; }
        .output-scroll::-webkit-scrollbar-track { background: var(--border); border-radius: 3px; }
        .output-scroll::-webkit-scrollbar-thumb { background: var(--accent-primary); border-radius: 3px; }
        .footer { text-align: center; color: var(--text-secondary); font-size: 0.7rem; margin-top: 40px; opacity: 0.6; }
        .tip-card { background: linear-gradient(135deg, rgba(99, 102, 241, 0.1) 0%, rgba(139, 92, 246, 0.1) 100%); border-color: rgba(99, 102, 241, 0.3); }
        .tip-label { color: var(--accent-primary); font-size: 0.7rem; font-weight: 700; text-transform: uppercase; margin-bottom: 10px; letter-spacing: 0.1em; }
        .tip-text { color: #cbd5e1; font-size: 0.85rem; line-height: 1.5; min-height: 50px; }
        .assets-label { color: var(--text-secondary); font-size: 0.65rem; font-weight: 700; text-transform: uppercase; margin-bottom: 12px; letter-spacing: 0.15em; }
        .section-divider { margin-top: 24px; padding-top: 20px; border-top: 1px solid var(--border); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const CONFIG = {
            BEEHIIV_MOCK_MODE: true,
            BEEHIIV_FORM_URL: "https://embeds.beehiiv.com/YOUR_EMBED_ID",
            LINKS: {
                INSTAGRAM: "https://instagram.com/koutalksmoney",
                CHATGPT: "https://chat.openai.com"
            }
        };

        const PROMPTS = {
            RESUME: `You are an executive resume writer who has placed candidates at Fortune 500 companies.
I'm applying for a {role} position at {company}. Here is my current resume:
{resume}

Your task:
1. Rewrite every bullet point using the "Action Verb + Metric + Impact" formula
2. Remove weak words like "responsible for," "helped with," "assisted"
3. Add quantifiable results wherever possible (even if I have to estimate)
4. Optimize for ATS (Applicant Tracking Systems) by including keywords from this job description:
{jobDesc}

Output the new resume in a clean, copyable format.`,

            COLD_EMAIL: `You are a copywriter who specializes in persuasive cold emails that get responses.
I'm applying for {role} at {company}. I don't have connections there, so I need a cover letter that makes them want to meet me.

Here's what you need to know:
- The job description: {jobDesc}
- My top 3 relevant skills/achievements: {skills}
- Why I actually want this job: {reason}

Write a 3-paragraph cover letter that:
1. Opens with a hook (not "I'm excited to apply...")
2. Proves I can solve their problem with a specific example
3. Ends with a confident ask for an interview
Keep it under 200 words. Make it sound like a human, not a robot.`,

            SIDE_HUSTLE: `You are a business strategist who helps people turn their existing skills into income streams.
I want to start a side hustle, but I don't know what I'm good at. Let's reverse-engineer it.

Here are my answers to your audit questions:
1. Friends ask me for help with: {friendsAsk}
2. Tasks easy for me but hard for others: {easyTask}
3. Free time interests: {interests}
4. Recent problem solved: {problemSolved}

Give me 3 side hustle ideas based on my responses. For each idea:
- Name the service
- Define the target customer
- Estimate how much I could charge
- Outline the 3-step plan to get my first client in 30 days.`,

            FIRE_CALC: `You are a financial independence advisor who helps people calculate their freedom number.
Here's my info:
- Current age: {age}
- Desired retirement age: {retireAge}
- Annual expenses (estimate): \${expenses}
- Current invested assets: \${invested}
- Monthly investment amount: \${monthlyInvest}
- Expected return rate: 8%

Calculate:
1. My FIRE number (total needed to live off 4% withdrawal)
2. How long until I hit that number at my current savings rate
3. If I want to retire by {retireAge}, how much do I need to invest monthly?
4. What happens if I increase my income by 20% and invest it all?
Show me the math in simple terms. Give me hope, but be realistic.`
        };

        const TIPS = [
            "\u{1F4A1} Pro Tip: Be specific. Vague input = Vague output.",
            "\u{1F4A1} Pro Tip: Treat AI like an intern. Give it examples.",
            "\u{1F4A1} Pro Tip: Chain prompts. Use Output A as Input for Prompt B.",
            "\u{1F4A1} Pro Tip: Use the 'Regenerate' button in ChatGPT if the first draft is weak."
        ];

        const PROCESSING_STEPS = [
            { id: 1, text: "Analyzing your input data..." },
            { id: 2, text: "Matching to optimal prompt structure..." },
            { id: 3, text: "Injecting personalized variables..." },
            { id: 4, text: "Formatting output for ChatGPT..." },
            { id: 5, text: "Finalizing your custom prompt..." }
        ];

        const CATEGORY_LABELS = { 'CAREER': '\u{1F4BC} Career', 'VENTURE': '\u{1F680} Venture', 'WEALTH': '\u{1F4B0} Wealth' };

        function getTimeAgo(timestamp) {
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            if (seconds < 60) return 'Just now';
            const minutes = Math.floor(seconds / 60);
            if (minutes < 60) return `${minutes}m ago`;
            const hours = Math.floor(minutes / 60);
            if (hours < 24) return `${hours}h ago`;
            return `${Math.floor(hours / 24)}d ago`;
        }

        function Gatekeeper({ onUnlock }) {
            const [progress, setProgress] = useState(0);
            useEffect(() => {
                const timer = setInterval(() => {
                    setProgress(prev => {
                        if (prev >= 100) { clearInterval(timer); setTimeout(onUnlock, 400); return 100; }
                        return prev + 3;
                    });
                }, 25);
                return () => clearInterval(timer);
            }, []);
            return (
                <div style={{minHeight:'100vh',display:'flex',flexDirection:'column',alignItems:'center',justifyContent:'center',background:'#0a0e27',padding:'20px'}}>
                    <div style={{textAlign:'center'}}>
                        <h1 className="gradient-text" style={{fontSize:'2rem',fontWeight:800,marginBottom:'12px'}}>THE VAULT</h1>
                        <p style={{color:'#6366f1',fontSize:'0.7rem',fontWeight:700,textTransform:'uppercase',letterSpacing:'0.15em',marginBottom:'24px'}}>Premium Access Verification</p>
                        <div style={{width:'240px',height:'4px',background:'#1a1f3a',borderRadius:'2px',overflow:'hidden',margin:'0 auto'}}>
                            <div style={{height:'100%',background:'linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)',transition:'width 0.1s',width:`${progress}%`}}></div>
                        </div>
                        <p style={{marginTop:'16px',fontSize:'0.7rem',color:'#64748b',fontFamily:"'JetBrains Mono', monospace"}}>{progress}% Complete</p>
                    </div>
                </div>
            );
        }

        function TheVault({ savedPrompts, isOpen, onToggle, onDelete, onCopy }) {
            const isEmpty = savedPrompts.length === 0;
            return (
                <div className="vault-container">
                    <div className={`vault-card ${isOpen ? 'expanded' : ''}`}>
                        <div className="vault-header" onClick={onToggle}>
                            <div className="vault-header-left">
                                <span className="vault-icon">{"\u{1F5C4}\uFE0F"}</span>
                                <div>
                                    <h2 className="vault-title">MY VAULT</h2>
                                    <p className="vault-subtitle">{isEmpty ? 'Generate prompts below to fill your vault' : `${savedPrompts.length} prompt${savedPrompts.length !== 1 ? 's' : ''} saved`}</p>
                                </div>
                            </div>
                            <div style={{display:'flex',alignItems:'center',gap:'12px'}}>
                                {!isEmpty && <div className="vault-badge"><span>{"\u{1F4BE}"}</span><span>{savedPrompts.length}</span></div>}
                                <span className={`vault-toggle ${isOpen ? 'open' : ''}`}>{"\u25BC"}</span>
                            </div>
                        </div>
                        <div className={`vault-content ${isOpen ? 'open' : ''}`}>
                            <div className="vault-content-inner">
                                {isEmpty ? (
                                    <div className="vault-empty">
                                        <div className="vault-empty-icon">{"\u{1F4ED}"}</div>
                                        <p className="vault-empty-text">Your vault is empty</p>
                                        <p className="vault-empty-hint">Generate a prompt below and unlock it with your email to save it here</p>
                                    </div>
                                ) : savedPrompts.map((item, index) => (
                                    <VaultPromptCard key={index} item={item} onCopy={() => onCopy(item.prompt)} onDelete={() => onDelete(index)} />
                                ))}
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        function VaultPromptCard({ item, onCopy, onDelete }) {
            const [copied, setCopied] = useState(false);
            const [expanded, setExpanded] = useState(false);
            const handleCopy = (e) => { e.stopPropagation(); navigator.clipboard.writeText(item.prompt); setCopied(true); setTimeout(() => setCopied(false), 2000); };
            const preview = item.prompt.substring(0, 120) + (item.prompt.length > 120 ? '...' : '');
            return (
                <div className="vault-prompt-card">
                    <div className="vault-prompt-header">
                        <div className="vault-prompt-meta">
                            <span className="vault-prompt-category">{CATEGORY_LABELS[item.category] || item.category}</span>
                            <span className="vault-prompt-time">{getTimeAgo(item.timestamp)}</span>
                        </div>
                        <div className="vault-prompt-actions">
                            <button onClick={handleCopy} className={`vault-prompt-btn ${copied ? 'copied' : ''}`}>{copied ? '\u2713' : '\u{1F4CB} Copy'}</button>
                            <button onClick={(e) => { e.stopPropagation(); onDelete(); }} className="vault-prompt-btn delete">{"\u{1F5D1}\uFE0F"}</button>
                        </div>
                    </div>
                    <div onClick={() => setExpanded(!expanded)}>
                        <pre className="vault-prompt-preview" style={{maxHeight: expanded ? 'none' : '80px', overflow:'hidden'}}>{expanded ? item.prompt : preview}</pre>
                        {item.prompt.length > 120 && <span className="vault-prompt-expand">{expanded ? '\u25B2 Collapse' : '\u25BC Expand full prompt'}</span>}
                    </div>
                </div>
            );
        }

        function VaultPointer({ isVisible, onDismiss }) {
            if (!isVisible) return null;
            return (
                <div className="vault-pointer">
                    <span className="vault-pointer-icon">{"\u261D\uFE0F"}</span>
                    <div className="vault-pointer-text">
                        <p className="vault-pointer-title">Prompt Saved to Your Vault!</p>
                        <p className="vault-pointer-subtitle">All your prompts are stored above. Click "MY VAULT" to access them anytime.</p>
                    </div>
                    <button className="vault-pointer-dismiss" onClick={onDismiss}>{"\u00D7"}</button>
                </div>
            );
        }

        /* --- NEW: Inline Vault Guide (post-email education) --- */
        function InlineVaultGuide({ isVisible }) {
            if (!isVisible) return null;
            return (
                <div className="vault-guide-inline">
                    <span className="vault-guide-icon">{"\u{1F5C4}\uFE0F"}</span>
                    <div className="vault-guide-content">
                        <p className="vault-guide-title">Your Vault is active.</p>
                        <p className="vault-guide-text">
                            Hit <strong>{"\u{1F4BE}"} Save to Vault</strong> on any prompt to store it permanently.
                            Your collection lives in the <strong>gold MY VAULT panel</strong> at the top of this page
                            — it persists between sessions, so you can close this tab and come back anytime.
                        </p>
                    </div>
                </div>
            );
        }

        function GoalGradientBar({ fields, requiredFields }) {
            const filledCount = requiredFields.filter(f => fields[f] && fields[f].trim() !== '').length;
            const progress = (filledCount / requiredFields.length) * 100;
            const isComplete = progress === 100;
            const progressColor = isComplete ? 'var(--success)' : progress > 0 ? 'linear-gradient(135deg, #6366f1 0%, #10b981 100%)' : 'var(--accent-gradient)';
            const percentColor = isComplete ? 'var(--success)' : progress > 0 ? '#10b981' : 'var(--accent-primary)';
            return (
                <div className="progress-container">
                    <div className="progress-header">
                        <span className="progress-label">Prompt Readiness</span>
                        <span className="progress-percent" style={{color:percentColor}}>{Math.round(progress)}%</span>
                    </div>
                    <div className="progress-bar-track">
                        <div className="progress-bar-fill" style={{width:`${Math.max(progress,5)}%`,background:progressColor}}></div>
                    </div>
                </div>
            );
        }

        function TransparencyPanel({ isProcessing, currentStep, isOpen, onToggle }) {
            return (
                <div className="transparency-panel">
                    <div className="transparency-header" onClick={onToggle}>
                        <span className="transparency-title"><span style={{fontSize:'0.9rem'}}>{"\u{1F50D}"}</span>See What's Happening</span>
                        <span className={`transparency-toggle ${isOpen ? 'open' : ''}`}>{"\u25BC"}</span>
                    </div>
                    <div className={`transparency-content ${isOpen ? 'open' : ''}`}>
                        {PROCESSING_STEPS.map((step, index) => (
                            <div key={step.id} className={`transparency-step ${isProcessing && currentStep === index ? 'active' : isProcessing && currentStep > index ? 'complete' : !isProcessing && currentStep >= PROCESSING_STEPS.length ? 'complete' : ''}`}>
                                <div className="step-indicator">{(!isProcessing && currentStep >= PROCESSING_STEPS.length) || (isProcessing && currentStep > index) ? '\u2713' : step.id}</div>
                                <span className="step-text">{step.text}</span>
                            </div>
                        ))}
                    </div>
                </div>
            );
        }

        function AchievementBanner({ isVisible, promptsGenerated, userName }) {
            const [copied, setCopied] = useState(false);
            const handleCopy = () => { navigator.clipboard.writeText(`I just earned AI Commander status in The Vault!\n\nGenerated ${promptsGenerated} custom prompts.\n\nGet yours: @koutalksmoney`); setCopied(true); setTimeout(() => setCopied(false), 2000); };
            if (!isVisible) return null;
            return (
                <div className="achievement-banner show">
                    <div className="achievement-icon">{"\u{1F3C6}"}</div>
                    <h3 className="achievement-title">Achievement Unlocked!</h3>
                    <p className="achievement-subtitle">You've earned AI Commander status by mastering all 3 categories</p>
                    <div className="achievement-card">
                        <div className="achievement-card-header">
                            <span className="achievement-card-logo">THE<span style={{color:'var(--gold)'}}>VAULT</span></span>
                            <span className="achievement-card-badge">AI Commander</span>
                        </div>
                        <div className="achievement-card-title">AI COMMANDER</div>
                        <div className="achievement-card-name">{userName || 'Elite Operator'}</div>
                        <div className="achievement-card-stats">
                            <div className="achievement-stat"><div className="achievement-stat-value">{promptsGenerated}</div><div className="achievement-stat-label">Prompts</div></div>
                            <div className="achievement-stat"><div className="achievement-stat-value">3/3</div><div className="achievement-stat-label">Categories</div></div>
                            <div className="achievement-stat"><div className="achievement-stat-value">{"\u2713"}</div><div className="achievement-stat-label">Elite</div></div>
                        </div>
                    </div>
                    <div className="achievement-share-btns">
                        <a href={CONFIG.LINKS.INSTAGRAM} target="_blank" className="achievement-share-btn instagram">{"\u{1F4F8}"} Share on Instagram</a>
                        <button className={`achievement-share-btn copy ${copied ? 'copied' : ''}`} onClick={handleCopy}>{copied ? '\u2713 Copied!' : '\u{1F4CB} Copy Caption'}</button>
                    </div>
                </div>
            );
        }

        function App() {
            const [locked, setLocked] = useState(true);
            const [activeTab, setActiveTab] = useState('CAREER');
            const [currentTip, setCurrentTip] = useState(0);
            const [savedPrompts, setSavedPrompts] = useState([]);
            const [promptsGenerated, setPromptsGenerated] = useState({ CAREER: 0, VENTURE: 0, WEALTH: 0 });
            const [showAchievement, setShowAchievement] = useState(false);
            const [userEmail, setUserEmail] = useState('');
            const [vaultOpen, setVaultOpen] = useState(false);
            const [showVaultPointer, setShowVaultPointer] = useState(false);
            const [justSignedUp, setJustSignedUp] = useState(false);

            useEffect(() => { const i = setInterval(() => setCurrentTip(p => (p+1) % TIPS.length), 6000); return () => clearInterval(i); }, []);
            useEffect(() => {
                const e = localStorage.getItem('vault_user_email'); if (e) setUserEmail(e);
                const p = localStorage.getItem('vault_saved_prompts'); if (p) setSavedPrompts(JSON.parse(p));
            }, []);
            useEffect(() => {
                if (Object.values(promptsGenerated).filter(c => c > 0).length >= 3 && !localStorage.getItem('vault_achievement_shown')) {
                    setShowAchievement(true); localStorage.setItem('vault_achievement_shown', 'true');
                }
            }, [promptsGenerated]);

            const handlePromptGenerated = (cat) => setPromptsGenerated(p => ({...p, [cat]: p[cat] + 1}));
            const handleEmailUnlock = (email, prompt, category) => {
                setUserEmail(email);
                localStorage.setItem('vault_user_email', email);
                localStorage.setItem('vault_email_captured', 'true');
                const newSaved = [...savedPrompts, { prompt, category, timestamp: Date.now() }];
                setSavedPrompts(newSaved);
                localStorage.setItem('vault_saved_prompts', JSON.stringify(newSaved));
                setVaultOpen(true);
                setShowVaultPointer(true);
                setJustSignedUp(true);
                setTimeout(() => setShowVaultPointer(false), 8000);
            };
            const handleSavePrompt = (prompt, category) => {
                const newSaved = [...savedPrompts, { prompt, category, timestamp: Date.now() }];
                setSavedPrompts(newSaved);
                localStorage.setItem('vault_saved_prompts', JSON.stringify(newSaved));
            };
            const handleDeletePrompt = (index) => {
                const newSaved = savedPrompts.filter((_, i) => i !== index);
                setSavedPrompts(newSaved);
                localStorage.setItem('vault_saved_prompts', JSON.stringify(newSaved));
            };
            const handleCopyPrompt = (prompt) => navigator.clipboard.writeText(prompt);

            if (locked) return <Gatekeeper onUnlock={() => setLocked(false)} />;
            const totalGenerated = Object.values(promptsGenerated).reduce((a, b) => a + b, 0);

            return (
                <div className="container">
                    <AchievementBanner isVisible={showAchievement} promptsGenerated={totalGenerated} userName={userEmail?.split('@')[0]} />
                    <div className="animate-fade-in" style={{textAlign:'center',marginBottom:'32px'}}>
                        <h1 className="gradient-text" style={{fontSize:'2.25rem',fontWeight:800,marginBottom:'8px'}}>The Vault</h1>
                        <p style={{color:'#94a3b8',fontSize:'0.95rem'}}>AI Command Console for High Performers</p>
                    </div>
                    <VaultPointer isVisible={showVaultPointer} onDismiss={() => setShowVaultPointer(false)} />
                    <TheVault savedPrompts={savedPrompts} isOpen={vaultOpen} onToggle={() => setVaultOpen(!vaultOpen)} onDelete={handleDeletePrompt} onCopy={handleCopyPrompt} />
                    <div className="main-grid">
                        <div className="space-y-6">
                            <div className="glass-card">
                                <div className="nav-container">
                                    {['CAREER', 'VENTURE', 'WEALTH'].map(tab => (
                                        <button key={tab} onClick={() => setActiveTab(tab)} className={`nav-pill ${activeTab === tab ? 'active' : ''}`}>
                                            {tab} OPS{promptsGenerated[tab] > 0 && <span style={{marginLeft:'6px',fontSize:'0.7rem',opacity:0.8}}>({promptsGenerated[tab]})</span>}
                                        </button>
                                    ))}
                                </div>
                            </div>
                            <div className="glass-card animate-fade-in">
                                {activeTab === 'CAREER' && <CareerModule onGenerated={() => handlePromptGenerated('CAREER')} onEmailUnlock={handleEmailUnlock} onSave={handleSavePrompt} userEmail={userEmail} justSignedUp={justSignedUp} />}
                                {activeTab === 'VENTURE' && <VentureModule onGenerated={() => handlePromptGenerated('VENTURE')} onEmailUnlock={handleEmailUnlock} onSave={handleSavePrompt} userEmail={userEmail} justSignedUp={justSignedUp} />}
                                {activeTab === 'WEALTH' && <WealthModule onGenerated={() => handlePromptGenerated('WEALTH')} onEmailUnlock={handleEmailUnlock} onSave={handleSavePrompt} userEmail={userEmail} justSignedUp={justSignedUp} />}
                            </div>
                        </div>
                        <div className="space-y-6">
                            <div className="glass-card tip-card">
                                <h3 className="tip-label">Intelligence Feed</h3>
                                <p className="tip-text">{TIPS[currentTip]}</p>
                            </div>
                            <div className="glass-card">
                                <h3 className="assets-label">External Assets</h3>
                                <div className="space-y-4">
                                    <a href={CONFIG.LINKS.CHATGPT} target="_blank" className="sidebar-link">Open ChatGPT</a>
                                    <a href={CONFIG.LINKS.INSTAGRAM} target="_blank" className="sidebar-link">DM @koutalksmoney</a>
                                </div>
                            </div>
                            <div className="glass-card">
                                <h3 className="assets-label">Your Progress</h3>
                                <div style={{fontSize:'0.8rem',color:'var(--text-secondary)'}}>
                                    <div style={{display:'flex',justifyContent:'space-between',marginBottom:'8px'}}><span>Prompts Generated:</span><span style={{color:'var(--success)',fontWeight:700}}>{totalGenerated}</span></div>
                                    <div style={{display:'flex',justifyContent:'space-between',marginBottom:'8px'}}><span>Categories Used:</span><span style={{color:'var(--accent-primary)',fontWeight:700}}>{Object.values(promptsGenerated).filter(c => c > 0).length}/3</span></div>
                                    <div style={{display:'flex',justifyContent:'space-between',marginBottom:'8px'}}><span>Prompts Saved:</span><span style={{color:'var(--gold)',fontWeight:700}}>{savedPrompts.length}</span></div>
                                    <div style={{display:'flex',justifyContent:'space-between'}}><span>Achievement:</span><span style={{color: showAchievement ? 'var(--gold)' : 'var(--text-muted)', fontWeight:700}}>{showAchievement ? '\u{1F3C6} Unlocked!' : '\u{1F512} Use 3 categories'}</span></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div className="footer">Architecture by Kou</div>
                </div>
            );
        }

        function CareerModule({ onGenerated, onEmailUnlock, onSave, userEmail, justSignedUp }) {
            const [mode, setMode] = useState('RESUME');
            const [inputs, setInputs] = useState({ role: '', company: '', resume: '', jobDesc: '', skills: '', reason: '' });
            const requiredFields = mode === 'RESUME' ? ['role','company','resume','jobDesc'] : ['role','company','jobDesc','skills','reason'];
            return (
                <div>
                    <div className="module-header">
                        <h2 className="module-title">Career Architect</h2>
                        <div className="module-tabs">
                            <button onClick={() => setMode('RESUME')} className={`module-tab ${mode === 'RESUME' ? 'active' : ''}`}>RESUME</button>
                            <span className="module-tab-divider">|</span>
                            <button onClick={() => setMode('EMAIL')} className={`module-tab ${mode === 'EMAIL' ? 'active' : ''}`}>COLD EMAIL</button>
                        </div>
                    </div>
                    <GoalGradientBar fields={inputs} requiredFields={requiredFields} />
                    <div className="space-y-5">
                        <div className="grid-2">
                            <Input label="Target Role" value={inputs.role} onChange={v => setInputs({...inputs, role: v})} placeholder="e.g. Product Manager" />
                            <Input label="Target Company" value={inputs.company} onChange={v => setInputs({...inputs, company: v})} placeholder="e.g. Google" />
                        </div>
                        {mode === 'RESUME' ? (<>
                            <TextArea label="Paste Old Resume" value={inputs.resume} onChange={v => setInputs({...inputs, resume: v})} placeholder="Paste content here..." />
                            <TextArea label="Job Description" value={inputs.jobDesc} onChange={v => setInputs({...inputs, jobDesc: v})} placeholder="Requirements..." />
                            <Generator template={PROMPTS.RESUME} data={inputs} btnText="Generate Resume Prompt" onGenerated={onGenerated} onEmailUnlock={onEmailUnlock} onSave={onSave} userEmail={userEmail} category="CAREER" justSignedUp={justSignedUp} />
                        </>) : (<>
                            <TextArea label="Job Description" value={inputs.jobDesc} onChange={v => setInputs({...inputs, jobDesc: v})} placeholder="Requirements..." />
                            <Input label="Top 3 Skills" value={inputs.skills} onChange={v => setInputs({...inputs, skills: v})} placeholder="e.g. SQL, Leadership, Sales" />
                            <Input label="Why This Job?" value={inputs.reason} onChange={v => setInputs({...inputs, reason: v})} placeholder="Authentic reason..." />
                            <Generator template={PROMPTS.COLD_EMAIL} data={inputs} btnText="Generate Email Prompt" onGenerated={onGenerated} onEmailUnlock={onEmailUnlock} onSave={onSave} userEmail={userEmail} category="CAREER" justSignedUp={justSignedUp} />
                        </>)}
                    </div>
                </div>
            );
        }

        function VentureModule({ onGenerated, onEmailUnlock, onSave, userEmail, justSignedUp }) {
            const [inputs, setInputs] = useState({ friendsAsk: '', easyTask: '', interests: '', problemSolved: '' });
            return (
                <div>
                    <div className="module-header"><h2 className="module-title">Side Hustle Generator</h2></div>
                    <GoalGradientBar fields={inputs} requiredFields={['friendsAsk','easyTask','interests','problemSolved']} />
                    <div className="space-y-5">
                        <Input label="What do friends ask you for?" value={inputs.friendsAsk} onChange={v => setInputs({...inputs, friendsAsk: v})} placeholder="e.g. Travel advice, Excel help" />
                        <Input label="What is easy for you?" value={inputs.easyTask} onChange={v => setInputs({...inputs, easyTask: v})} placeholder="e.g. Organizing files" />
                        <Input label="Free time interests?" value={inputs.interests} onChange={v => setInputs({...inputs, interests: v})} placeholder="e.g. Fitness, Crypto" />
                        <Input label="Recent problem solved?" value={inputs.problemSolved} onChange={v => setInputs({...inputs, problemSolved: v})} placeholder="e.g. Fixed my wifi" />
                        <Generator template={PROMPTS.SIDE_HUSTLE} data={inputs} btnText="Analyze My Market Value" onGenerated={onGenerated} onEmailUnlock={onEmailUnlock} onSave={onSave} userEmail={userEmail} category="VENTURE" justSignedUp={justSignedUp} />
                    </div>
                </div>
            );
        }

        function WealthModule({ onGenerated, onEmailUnlock, onSave, userEmail, justSignedUp }) {
            const [inputs, setInputs] = useState({ age: '', retireAge: '40', expenses: '', invested: '0', monthlyInvest: '' });
            return (
                <div>
                    <div className="module-header"><h2 className="module-title">Freedom Calculator (FIRE)</h2></div>
                    <GoalGradientBar fields={inputs} requiredFields={['age','retireAge','expenses','monthlyInvest']} />
                    <div className="space-y-5">
                        <div className="grid-2">
                            <Input label="Current Age" value={inputs.age} onChange={v => setInputs({...inputs, age: v})} placeholder="25" />
                            <Input label="Target Retire Age" value={inputs.retireAge} onChange={v => setInputs({...inputs, retireAge: v})} placeholder="40" />
                        </div>
                        <Input label="Annual Expenses ($)" value={inputs.expenses} onChange={v => setInputs({...inputs, expenses: v})} placeholder="50000" />
                        <div className="grid-2">
                            <Input label="Invested Assets ($)" value={inputs.invested} onChange={v => setInputs({...inputs, invested: v})} placeholder="10000" />
                            <Input label="Monthly Contrib ($)" value={inputs.monthlyInvest} onChange={v => setInputs({...inputs, monthlyInvest: v})} placeholder="500" />
                        </div>
                        <Generator template={PROMPTS.FIRE_CALC} data={inputs} btnText="Calculate My Freedom Date" onGenerated={onGenerated} onEmailUnlock={onEmailUnlock} onSave={onSave} userEmail={userEmail} category="WEALTH" justSignedUp={justSignedUp} />
                    </div>
                </div>
            );
        }

        function Input({ label, value, onChange, placeholder }) {
            return (<div className="input-group"><label>{label}</label><input type="text" value={value} onChange={e => onChange(e.target.value)} placeholder={placeholder} className="premium-input" /></div>);
        }
        function TextArea({ label, value, onChange, placeholder }) {
            return (<div className="input-group"><label>{label}</label><textarea value={value} onChange={e => onChange(e.target.value)} placeholder={placeholder} rows={4} className="premium-textarea" /></div>);
        }

        /* === THE BLUR GATE GENERATOR — WITH SAVE ANIMATION + INLINE GUIDE === */
        function Generator({ template, data, btnText, onGenerated, onEmailUnlock, onSave, userEmail, category, justSignedUp }) {
            const [generated, setGenerated] = useState(null);
            const [isUnlocked, setIsUnlocked] = useState(false);
            const [copied, setCopied] = useState(false);
            const [saved, setSaved] = useState(false);
            const [isProcessing, setIsProcessing] = useState(false);
            const [currentStep, setCurrentStep] = useState(0);
            const [panelOpen, setPanelOpen] = useState(true);
            const [showInlineGuide, setShowInlineGuide] = useState(false);
            const [gateEmail, setGateEmail] = useState('');
            const [gateError, setGateError] = useState('');
            const [gateSubmitting, setGateSubmitting] = useState(false);

            useEffect(() => { if (userEmail) setIsUnlocked(true); }, [userEmail]);
            // Show inline guide when user just signed up and this prompt unlocks
            useEffect(() => { if (justSignedUp && isUnlocked && generated) setShowInlineGuide(true); }, [justSignedUp, isUnlocked, generated]);

            const handleGenerate = () => {
                setIsProcessing(true); setGenerated(null); setCurrentStep(0);
                setPanelOpen(true); setSaved(false); setIsUnlocked(!!userEmail); setShowInlineGuide(false);
                PROCESSING_STEPS.forEach((_, i) => { setTimeout(() => setCurrentStep(i + 1), 600 * (i + 1)); });
                setTimeout(() => {
                    let text = template;
                    Object.keys(data).forEach(key => { text = text.replace(new RegExp(`{${key}}`, 'g'), data[key] || `[INSERT ${key.toUpperCase()}]`); });
                    setGenerated(text); setIsProcessing(false); setCopied(false); onGenerated();
                }, 3000);
            };

            const handleUnlock = async () => {
                if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(gateEmail)) { setGateError('Enter a valid email to unlock'); return; }
                setGateSubmitting(true); setGateError('');
                await new Promise(r => setTimeout(r, 1200));
                setIsUnlocked(true); setGateSubmitting(false); setShowInlineGuide(true);
                onEmailUnlock(gateEmail, generated, category);
            };

            const handleCopy = () => { navigator.clipboard.writeText(generated); setCopied(true); setTimeout(() => setCopied(false), 2000); };
            const handleSave = () => { onSave(generated, category); setSaved(true); setTimeout(() => setSaved(false), 2000); };

            const getVisiblePortion = (text) => {
                if (!text) return { visible: '', blurred: '' };
                const cutoff = Math.floor(text.length * 0.18);
                return { visible: text.substring(0, cutoff), blurred: text.substring(cutoff) };
            };
            const portions = generated ? getVisiblePortion(generated) : { visible: '', blurred: '' };

            return (
                <div className="section-divider">
                    <button onClick={handleGenerate} className="btn-primary" disabled={isProcessing}>{isProcessing ? 'Processing...' : btnText}</button>
                    {(isProcessing || generated) && <TransparencyPanel isProcessing={isProcessing} currentStep={currentStep} isOpen={panelOpen} onToggle={() => setPanelOpen(!panelOpen)} />}
                    {isProcessing && (
                        <div className="loading-container">
                            <div className="loading-spinner"></div>
                            <div className="loading-text">{PROCESSING_STEPS[Math.min(currentStep, PROCESSING_STEPS.length - 1)]?.text || 'Initializing...'}</div>
                            <div className="loading-subtext">This takes a moment to ensure quality</div>
                        </div>
                    )}

                    {/* BLUR GATE (Locked) */}
                    {generated && !isProcessing && !isUnlocked && (
                        <div className="blur-gate-container animate-fade-in">
                            <div className="blur-gate-preview">
                                <pre className="blur-gate-visible">{portions.visible}</pre>
                                <pre className="blur-gate-blurred">{portions.blurred}</pre>
                                <div className="blur-gate-overlay">
                                    <div className="blur-gate-lock">{"\u{1F512}"}</div>
                                    <h3 className="blur-gate-title">Unlock Full Prompt</h3>
                                    <p className="blur-gate-subtitle">Enter your email to unlock the complete prompt and save it to your Vault forever.</p>
                                    <input type="email" value={gateEmail} onChange={(e) => { setGateEmail(e.target.value); setGateError(''); }} placeholder="your@email.com" className={`blur-gate-input ${gateError ? 'error' : ''}`} disabled={gateSubmitting} />
                                    {gateError && <p className="blur-gate-error">{gateError}</p>}
                                    <button onClick={handleUnlock} disabled={!gateEmail || gateSubmitting} className="blur-gate-btn">
                                        {gateSubmitting ? (<><span className="loading-spinner" style={{width:'18px',height:'18px',margin:0,borderWidth:'2px'}}></span><span>Unlocking...</span></>) : '[ \u{1F513} Unlock & Save to Vault ]'}
                                    </button>
                                    <div className="blur-gate-trust"><span>{"\u{1F512}"} Secure</span><span>{"\u2022"}</span><span>No spam</span><span>{"\u2022"}</span><span>Instant access</span></div>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* UNLOCKED OUTPUT */}
                    {generated && !isProcessing && isUnlocked && (
                        <>
                            <div className="output-box animate-fade-in">
                                <div className="output-header">
                                    <span className="output-status">Prompt Unlocked</span>
                                    <div>
                                        <button onClick={handleCopy} className={`copy-btn ${copied ? 'copied' : ''}`}>{copied ? "\u2713 Copied" : "Copy to Clipboard"}</button>
                                        <button onClick={handleSave} className={`save-btn ${saved ? 'saved-flash' : ''}`}>{saved ? "\u2713 Vaulted" : "\u{1F4BE} Save to Vault"}</button>
                                    </div>
                                </div>
                                <div className="output-scroll"><pre className="output-code">{generated}</pre></div>
                            </div>
                            {/* INLINE VAULT GUIDE — shows after first email unlock */}
                            <InlineVaultGuide isVisible={showInlineGuide} />
                        </>
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
